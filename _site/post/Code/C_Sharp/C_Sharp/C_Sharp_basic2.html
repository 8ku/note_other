<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- <link rel="stylesheet" href="/note_other/assets/css/syntax.css"> -->
    
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>c# | note_other</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="c#" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="书籍以外的各种笔记" />
<meta property="og:description" content="书籍以外的各种笔记" />
<link rel="canonical" href="http://localhost:4000/note_other/post/Code/C_Sharp/C_Sharp/C_Sharp_basic2.html" />
<meta property="og:url" content="http://localhost:4000/note_other/post/Code/C_Sharp/C_Sharp/C_Sharp_basic2.html" />
<meta property="og:site_name" content="note_other" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="c#" />
<script type="application/ld+json">
{"url":"http://localhost:4000/note_other/post/Code/C_Sharp/C_Sharp/C_Sharp_basic2.html","headline":"c#","description":"书籍以外的各种笔记","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <!-- 字体自适应放大 -->
    <link rel="stylesheet" href="/note_other/assets/css/style.css?v=abcebee436e3ff7eeb87eb5b08d3e596ca408ae1">
    <script src="/note_other/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- 显示页内目录 -->
    <!-- <script src="https://raw.githubusercontent.com/8ku/note_other/master/_js/jquery-3.5.1.min.js" type="text/javascript"></script> 
    <script src="https://raw.githubusercontent.com/8ku/note_other/master/_js/toc.js" type="text/javascript"></script> -->


	<!-- 显示数学公式 -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script> 

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">

    <script type="text/javascript" src="/note_other/assets/js/search-box.js"></script>

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>

    <!-- Search box -->
            <div class="search">
                <i class="material-icons search-icon search-start">search</i>
                <input type="text" class="search-input" placeholder="Searching...（支持正则表达式）" />
                <i class="material-icons search-icon search-clear">clear</i>
                <div class="search-results"></div>
            </div>

    <div class="wrapper">
      <header>
        <h1 class="header"><a href="/note_other">note_other</a></h1>
        <p class="header">书籍以外的各种笔记</p>    
        <ul> 
          <li><a class="header name" href="https://8ku.github.io/note_other/search">Search</a></li>     	
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/Code/summary">Code</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/Unity/summary">Unity</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/math/summary">Math</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/RegularExpression/summary">RegularExpression</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/system/summary">System</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/WomensHistory/summary">WomensHistory</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/mythology/summary">Mythology</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/GameHistory/summary">GameHistory</a></li>
        	<li><a class="header name" href="/note_other/post/Biology/summary">Biology</a></li>
        	<li><a class="header name" href="/note_other/post/Draw/summary">Draw</a></li>
        </ul>


        <!--<ul>
          
          <li><a class="buttons github" href="https://github.com/8ku/note_other">View On GitHub</a></li>
        </ul> 

        
          <p class="header">This project is maintained by <a class="header name" href="https://github.com/8ku">8ku</a></p>
        

         -->
      </header>

      <div id="toc"></div>
      <section>

        <h1 id="c">c#</h1>

<ul id="markdown-toc">
  <li><a href="#c" id="markdown-toc-c">c#</a>    <ul>
      <li><a href="#static" id="markdown-toc-static">static</a></li>
      <li><a href="#params" id="markdown-toc-params">params</a></li>
      <li><a href="#调试" id="markdown-toc-调试">调试</a>        <ul>
          <li><a href="#断点调试" id="markdown-toc-断点调试">断点调试</a></li>
          <li><a href="#异常处理" id="markdown-toc-异常处理">异常处理</a></li>
        </ul>
      </li>
      <li><a href="#属性" id="markdown-toc-属性">属性</a>        <ul>
          <li><a href="#c-7o-get-set-的变化" id="markdown-toc-c-7o-get-set-的变化">C# 7.O get set 的变化</a></li>
          <li><a href="#自动实现的属性如果字段中没有逻辑可以简化" id="markdown-toc-自动实现的属性如果字段中没有逻辑可以简化">自动实现的属性(如果字段中没有逻辑，可以简化)</a></li>
        </ul>
      </li>
      <li><a href="#派生类构造方法" id="markdown-toc-派生类构造方法">派生类构造方法</a></li>
      <li><a href="#接口" id="markdown-toc-接口">接口</a></li>
      <li><a href="#继承的一个例子" id="markdown-toc-继承的一个例子">继承的一个例子</a></li>
      <li><a href="#列表" id="markdown-toc-列表">列表</a>        <ul>
          <li><a href="#数组和列表的区别" id="markdown-toc-数组和列表的区别">数组和列表的区别</a></li>
        </ul>
      </li>
      <li><a href="#泛型类" id="markdown-toc-泛型类">泛型类</a></li>
      <li><a href="#一些零碎的点" id="markdown-toc-一些零碎的点">一些零碎的点</a>        <ul>
          <li><a href="#string" id="markdown-toc-string">String</a></li>
          <li><a href="#string和stringbuilder类型" id="markdown-toc-string和stringbuilder类型">String和StringBuilder类型</a></li>
          <li><a href="#特性-obsolete-方法弃用提示" id="markdown-toc-特性-obsolete-方法弃用提示">[特性] Obsolete 方法弃用提示</a></li>
          <li><a href="#特性-conditional-控制方法的调用" id="markdown-toc-特性-conditional-控制方法的调用">[特性] Conditional 控制方法的调用</a></li>
          <li><a href="#特性-debuggerstepthrough-在调试时跳过该方法" id="markdown-toc-特性-debuggerstepthrough-在调试时跳过该方法">[特性] DebuggerStepThrough 在调试时跳过该方法</a></li>
          <li><a href="#创建自己的特性类自定义标签" id="markdown-toc-创建自己的特性类自定义标签">创建自己的特性类(自定义标签)</a></li>
        </ul>
      </li>
      <li><a href="#正则表达式" id="markdown-toc-正则表达式">正则表达式</a></li>
      <li><a href="#委托和-lambda" id="markdown-toc-委托和-lambda">委托和 Lambda</a>        <ul>
          <li><a href="#action委托没有返回值" id="markdown-toc-action委托没有返回值">Action委托(没有返回值)</a></li>
          <li><a href="#func委托必须有返回值" id="markdown-toc-func委托必须有返回值">Func委托（必须有返回值）</a></li>
          <li><a href="#多播委托" id="markdown-toc-多播委托">多播委托</a></li>
          <li><a href="#匿名方法" id="markdown-toc-匿名方法">匿名方法</a></li>
          <li><a href="#lambda" id="markdown-toc-lambda">Lambda</a></li>
          <li><a href="#事件" id="markdown-toc-事件">事件</a></li>
        </ul>
      </li>
      <li><a href="#排序的拓展方法适用于任何类型的排序" id="markdown-toc-排序的拓展方法适用于任何类型的排序">排序的拓展方法（适用于任何类型的排序）</a></li>
      <li><a href="#linq查询" id="markdown-toc-linq查询">LINQ查询</a>        <ul>
          <li><a href="#查询复杂list对象" id="markdown-toc-查询复杂list对象">查询复杂list对象</a></li>
        </ul>
      </li>
      <li><a href="#文件操作" id="markdown-toc-文件操作">文件操作</a>        <ul>
          <li><a href="#文件属性读取操作" id="markdown-toc-文件属性读取操作">文件属性读取操作</a></li>
          <li><a href="#文件夹属性读取操作" id="markdown-toc-文件夹属性读取操作">文件夹属性读取操作</a></li>
          <li><a href="#文件内容读写" id="markdown-toc-文件内容读写">文件内容读写</a></li>
        </ul>
      </li>
      <li><a href="#xml--json" id="markdown-toc-xml--json">XML  JSON</a>        <ul>
          <li><a href="#xml" id="markdown-toc-xml">XML</a></li>
          <li><a href="#json" id="markdown-toc-json">json</a></li>
          <li><a href="#用-litjson-解析json" id="markdown-toc-用-litjson-解析json">用 LitJson 解析Json</a></li>
          <li><a href="#用-newtonsoftjson-解析json" id="markdown-toc-用-newtonsoftjson-解析json">用 Newtonsoft.Json 解析Json</a></li>
        </ul>
      </li>
      <li><a href="#oldb操作数据库及excel" id="markdown-toc-oldb操作数据库及excel">OLDB操作数据库及excel</a></li>
    </ul>
  </li>
</ul>

<h2 id="static">static</h2>

<p>不使用 static 的默认为 auto。</p>

<ul>
  <li><strong>auto</strong>：由程序自动控制变量的生命周期，通常是变量在被触发时被分配，结束时释放</li>
  <li><strong>static</strong>：按程序的生命周期来分配释放变量，在程序初始化时被分配，程序退出时释放，按程序的生命周期来分配释放变量，而不是变量自己的生命周期。即<strong>在程序运行期间一直占用内存空间。</strong></li>
</ul>

<p>如果一个类经常被调用，就写成静态类，相反就不要写成静态类，以节省内存。</p>

<h2 id="params">params</h2>

<p>参数数组，使用这个关键字你可以直接在调用时传入数组的值，而不需要在调用是重新构造一个数组再传入。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="c1">// 构造一个 int 类型的参数数组</span>
<span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">UserParams</span><span class="p">(</span><span class="k">params</span> <span class="kt">int</span><span class="p">[]</span> <span class="n">list</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span><span class="p">&lt;</span> <span class="n">list</span><span class="p">.</span><span class="n">Lengh</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
  <span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">+</span> <span class="s">" "</span><span class="p">);</span> <span class="c1">//输出在一行中</span>
  <span class="p">}</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">();</span> <span class="c1">//把该方法的结果输出在新一行中</span>
<span class="p">}</span>

<span class="c1">// 构造一个不限类型的数组 (object类型）</span>
<span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">UserParam2</span><span class="p">(</span><span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">list</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span><span class="p">&lt;</span> <span class="n">list</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
  <span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">+</span> <span class="s">" "</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// 调用方法</span>
<span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="nf">UserParams</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">6</span><span class="p">);</span>
  <span class="nf">UserParams2</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="s">"2"</span><span class="p">,</span><span class="s">"we"</span><span class="p">,</span><span class="s">"为什么"</span><span class="p">)</span><span class="err">；</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="调试">调试</h2>

<h3 id="断点调试">断点调试</h3>

<p>在要打断点的行头点击，即可打断点，运行时，会在打断点的地方停下来。</p>

<h3 id="异常处理">异常处理</h3>

<p>使用 try catch finally 语句来处理异常.</p>

<p>try用于预测可能出现的异常。捕获异常并对异常进行处理，就在catch中实现。不管异常发生与否，都会执行finally里面的语句。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">try</span> <span class="c1">//用于检测异常，当 try 中的语句发生异常时，用 catch 捕捉</span>
                <span class="p">{</span>
                    <span class="kt">int</span> <span class="n">num1</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">());</span> 
                    <span class="k">break</span><span class="p">;</span> <span class="c1">//如果输入的是正确的形式, 即 try 语句正确执行, 用 break 跳出 while 循环；如果 try 报错，会进入 catch 块</span>
                <span class="p">}</span>
                <span class="k">catch</span>
                <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"should be a number, please try again."</span><span class="p">);</span>
                <span class="p">}</span>

            <span class="p">}</span>
        <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="属性">属性</h2>

<p>可以给字段设置带处理的值，即在属性中处理字段，并输出结果给字段。这让字段的设置更灵活。</p>

<ul>
  <li>只读属性：只有 get ，没有 set</li>
  <li>只写属性：只有 set ，没有 get（很少出现）</li>
  <li>value关键字：用户定义由 set 访问器分配的值</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">TimePeriod</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="kt">double</span> <span class="n">hours</span><span class="p">;</span> <span class="c1">//设置一个字段接收实参的值</span>
        <span class="k">public</span> <span class="kt">double</span> <span class="n">Hours</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">hours</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// get 返回属性值</span>
            <span class="k">set</span> <span class="c1">// set 分配新值</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">value</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="k">value</span> <span class="p">&lt;</span> <span class="m">24</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">hours</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Time is hours: </span><span class="p">{</span><span class="n">hours</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="n">hours</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">hours</span><span class="p">}</span><span class="s"> must be between 0 and 24."</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">class</span> <span class="nc">baku</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimePeriod</span> <span class="n">t</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TimePeriod</span><span class="p">();</span> <span class="c1">//构造</span>
            <span class="n">t</span><span class="p">.</span><span class="n">Hours</span> <span class="p">=</span> <span class="m">11</span><span class="p">;</span> <span class="c1">//调用 TimePeriod 类中的 Hours字段，给 hours 赋值</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="c-7o-get-set-的变化">C# 7.O get set 的变化</h3>

<p>可以作为 expression-bodied 成员实现，不使用 return.</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">SaleItem</span>
    <span class="p">{</span>
        <span class="kt">string</span> <span class="n">_name</span><span class="p">;</span>
        <span class="kt">decimal</span> <span class="n">_cost</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">SaleItem</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span><span class="kt">decimal</span> <span class="n">cost</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_name</span> <span class="p">=</span> <span class="n">name</span><span class="p">;</span>
            <span class="n">_cost</span> <span class="p">=</span> <span class="n">cost</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">=&gt;</span> <span class="n">_name</span><span class="p">;</span>
            <span class="k">set</span> <span class="p">=&gt;</span> <span class="n">_name</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="kt">decimal</span> <span class="n">Price</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">=&gt;</span> <span class="n">_cost</span><span class="p">;</span>
            <span class="k">set</span> <span class="p">=&gt;</span> <span class="n">_cost</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">SaleItem</span> <span class="n">item</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SaleItem</span><span class="p">(</span><span class="s">"Shoes"</span><span class="p">,</span><span class="m">19.95</span><span class="n">m</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">item</span><span class="p">.</span><span class="n">Name</span><span class="p">}</span><span class="s">: sells for </span><span class="p">{</span><span class="n">item</span><span class="p">.</span><span class="n">Price</span><span class="p">:</span><span class="n">c2</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="自动实现的属性如果字段中没有逻辑可以简化">自动实现的属性(如果字段中没有逻辑，可以简化)</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">SaleItem</span>
<span class="p">{</span>
   <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> 
   <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

   <span class="k">public</span> <span class="kt">decimal</span> <span class="n">Price</span>
   <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
   <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
   <span class="p">{</span>
      <span class="kt">var</span> <span class="n">item</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SaleItem</span><span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"Shoes"</span><span class="p">,</span> <span class="n">Price</span> <span class="p">=</span> <span class="m">19.95</span><span class="n">m</span> <span class="p">};</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">item</span><span class="p">.</span><span class="n">Name</span><span class="p">}</span><span class="s">: sells for </span><span class="p">{</span><span class="n">item</span><span class="p">.</span><span class="n">Price</span><span class="p">:</span><span class="n">C2</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="派生类构造方法">派生类构造方法</h2>

<p>派生类调用基类的方法</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c1">// 派生类中，用 base 来调用基类的构造方法</span>
<span class="c1">// 如果不用 :base，默认会调用基类中的无参构造方法</span>
<span class="k">public</span> <span class="nf">DerivedClass</span><span class="p">():</span><span class="k">base</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="接口">接口</h2>

<p>使用 interface 关键字定义接口。</p>

<p>类与类之间叫<strong>继承</strong>，类与接口之间叫<strong>实现</strong>。</p>

<p><strong>接口类似于只有抽象成员的抽象基类。实现接口的任何类或结构都必须实现其所有成员。</strong></p>

<ul>
  <li>接口名称必须是有效的c#标识符名称，接口名称以大写字母 I 开头。</li>
  <li>接口无法直接进行实例化</li>
  <li>
    <p>接口之间也可继承，继承接口和继承方法一样</p>
  </li>
  <li>
    <p>接口可包含方法、属性、事件、索引器或这四种成员类型的任意组合。</p>
  </li>
  <li>接口不能包含常量、字段、运算符、实例构造函数、终结器或类型。 接口成员会自动成为公共成员，不能包含任何访问修饰符。不能是静态成员。</li>
  <li>若要实现接口成员，实现类的对应成员必须是公共、非静态，并且具有与接口成员相同的名称和签名。</li>
  <li>一个类或结构可以实现多个接口。一个类可以继承一个基类，还可实现一个或多个接口。</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="c1">// 基类</span>
<span class="k">class</span> <span class="nc">BaseClass</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="nf">BCMethod</span><span class="p">()</span>
  <span class="p">{</span>
    
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 定义接口</span>
<span class="k">interface</span> <span class="nc">Ifly</span>
<span class="p">{</span>
  <span class="k">void</span> <span class="nf">Fly</span><span class="p">();</span>
  <span class="k">void</span> <span class="nf">MethodA</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">//继承接口</span>
<span class="k">interface</span> <span class="nc">Ib</span><span class="p">:</span><span class="n">Ifly</span>
<span class="p">{</span>
  <span class="k">void</span> <span class="nf">MethodC</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// 实现接口</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">MyClass</span><span class="p">:</span><span class="n">Ib</span><span class="p">,</span><span class="n">BaseClass</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">void</span> <span class="nf">Fly</span><span class="p">()</span> <span class="c1">//实现接口必须把接口内的所有成员实现，这个方法属于 IFly 接口</span>
  <span class="p">{</span>
    
  <span class="p">}</span>
  <span class="k">public</span> <span class="k">void</span> <span class="nf">MethodA</span><span class="p">()</span> <span class="c1">//这个方法属于 IFly 接口</span>
  <span class="p">{</span>
    
  <span class="p">}</span>
  
  <span class="k">public</span> <span class="k">void</span> <span class="nf">MethodC</span><span class="p">()</span> <span class="c1">//这个方法属于 Ib 接口(如果一个接口属于另一个基类接口，实现该接口时，必须也实现其基类接口)</span>
  <span class="p">{</span>
    
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="继承的一个例子">继承的一个例子</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">A</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">Fun1</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Fun2</span><span class="p">(</span><span class="n">A</span> <span class="n">a</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">a</span><span class="p">.</span><span class="nf">Fun1</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
            <span class="nf">Fun1</span><span class="p">(</span><span class="m">5</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">}</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">B</span> <span class="p">:</span> <span class="n">A</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">Fun1</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">Fun1</span><span class="p">(</span><span class="n">i</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">B</span> <span class="n">b</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">B</span><span class="p">();</span>
            <span class="n">A</span> <span class="n">a</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">A</span><span class="p">();</span>

            <span class="n">a</span><span class="p">.</span><span class="nf">Fun2</span><span class="p">(</span><span class="n">b</span><span class="p">);</span> 
            <span class="cm">/*a 调用 class A 中的Fun2,传参b
            即为 Fun2(b){b.Fun1(1); Fun1(5);}   
            b.Fun1() = A.Fun1(i+1) = 2 
            Fun1(5) = A.Fun2(){Fun1(5)} = 5 */</span>
            <span class="n">b</span><span class="p">.</span><span class="nf">Fun2</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> 
          	<span class="cm">/*b 调用基类class A 中的Fun2,传参a
          	即为 Fun2(a){a.Fun1(1);Fun1(5);}
          	a.Fun1() = 1 
          	Fun1(5) = (override)b.Fun1(i+1) = 6 */</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="列表">列表</h2>

<h3 id="数组和列表的区别">数组和列表的区别</h3>

<ul>
  <li>数组必须有初始大小或具体值
    <ul>
      <li>指定大小： <code class="language-plaintext highlighter-rouge">int[] a = new int[10];</code></li>
      <li>指定初始值：<code class="language-plaintext highlighter-rouge">int[] a = new int[]{1,2,3};</code></li>
      <li>指定初始值，系统自动推断大小：<code class="language-plaintext highlighter-rouge"> int[] a = {1,2,3};</code></li>
    </ul>
  </li>
  <li>ArrayList 类，是System.Collections下的类，大小是按存储的数据动态扩充和收缩。
    <ul>
      <li><strong>不建议使用ArrayList进行开发，建议使用泛型<code class="language-plaintext highlighter-rouge">List&lt;T&gt;</code>。</strong></li>
      <li>ArrayList把数据当做Object处理，允许插入不同类型的数据，在使用中如果不清楚具体值的数据类型，会报类型不匹配，需要转化使用（装箱拆箱）<strong>即ArrayList是不严谨的。</strong></li>
      <li>初始化时不需要指定大小： `ArrayList list = new ArrayList();</li>
      <li>新增数据： <code class="language-plaintext highlighter-rouge">list.Add(“abc”);</code></li>
      <li>修改数据：<code class="language-plaintext highlighter-rouge">list[2]=345;</code></li>
      <li>移除数据： <code class="language-plaintext highlighter-rouge">list.RemoveAt(0);</code></li>
      <li>插入数据：<code class="language-plaintext highlighter-rouge">list.Insert(0,”hello world”);</code></li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">List&lt;T&gt;</code>类
    <ul>
      <li><code class="language-plaintext highlighter-rouge">list&lt;T&gt;</code>类初始化时必须指定一个类型，int string 或自定class</li>
      <li>避免了 ArrayList 会出现的类型不匹配的报错</li>
    </ul>
  </li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="c1">// 创建列表的2种方式，使用泛型 List&lt;T&gt;</span>
<span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">scoreList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>
<span class="kt">var</span> <span class="n">scoreList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>
<span class="c1">// 插入数据的方式</span>
<span class="n">scoreList</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="m">12</span><span class="p">);</span>
<span class="c1">// 读取列表数据</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">scoreList</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>
<span class="c1">// 读取列表的数据个数</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">scoreList</span><span class="p">.</span><span class="n">Count</span><span class="p">);</span>
<span class="c1">//读取列表的容量大小,容量大小默认为4，不够用时以倍数扩容，8，16，32; 可用 list.Capacity(10)来指定容量大小，扩容按指定容量大小2倍扩容，20，40，80</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">scoreList</span><span class="p">.</span><span class="n">Capacity</span><span class="p">);</span>
<span class="c1">//移除指定位置元素</span>
<span class="n">scoreList</span><span class="p">.</span><span class="nf">RemoveAt</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
<span class="c1">//取得一个元素在列表中的索引位置，如果位置不存在，返回-1</span>
<span class="n">scoreList</span><span class="p">.</span><span class="nf">IndexOf</span><span class="p">(</span><span class="m">20</span><span class="p">);</span>
<span class="n">scoreList</span><span class="p">.</span><span class="nf">LastIndexOf</span><span class="p">(</span><span class="m">2</span><span class="p">);</span> <span class="c1">//从后向前搜索</span>
<span class="c1">//排序</span>
<span class="n">scoreList</span><span class="p">.</span><span class="nf">Sort</span><span class="p">();</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="泛型类">泛型类</h2>

<p>关键字 <code class="language-plaintext highlighter-rouge">&lt;T&gt;</code>，定义时只需要用 T 代表类型，在构造时需要指定 T 的类型</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">GenericList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Add</span><span class="p">(</span><span class="n">T</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
<span class="k">class</span> <span class="nc">TestGenericList</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">class</span> <span class="nc">ExampleClass</span> <span class="p">{</span> <span class="p">}</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// Declare a list of type int.</span>
        <span class="n">GenericList</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">list1</span> <span class="p">=</span> <span class="k">new</span> <span class="n">GenericList</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>
        <span class="n">list1</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>

        <span class="c1">// Declare a list of type string.</span>
        <span class="n">GenericList</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">list2</span> <span class="p">=</span> <span class="k">new</span> <span class="n">GenericList</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
        <span class="n">list2</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">""</span><span class="p">);</span>

        <span class="c1">// Declare a list of type ExampleClass.</span>
        <span class="n">GenericList</span><span class="p">&lt;</span><span class="n">ExampleClass</span><span class="p">&gt;</span> <span class="n">list3</span> <span class="p">=</span> <span class="k">new</span> <span class="n">GenericList</span><span class="p">&lt;</span><span class="n">ExampleClass</span><span class="p">&gt;();</span>
        <span class="n">list3</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">ExampleClass</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="一些零碎的点">一些零碎的点</h2>

<h3 id="string">String</h3>

<p>注意 char 和 string 的符号，单引号和双引号</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kt">string</span> <span class="n">s</span>  <span class="p">=</span> <span class="s">"www.helloworld.com"</span><span class="p">;</span>
<span class="kt">string</span> <span class="n">newS</span> <span class="p">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="sc">'.'</span><span class="p">,</span><span class="sc">'-'</span><span class="p">);</span> <span class="c1">//char 要用 ' '</span>
<span class="kt">string</span> <span class="n">newS</span> <span class="p">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="s">"."</span><span class="p">,</span><span class="s">"---"</span><span class="p">)</span> <span class="c1">//string 要用 " "</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="string和stringbuilder类型">String和StringBuilder类型</h3>

<p>对String对象每个操作都会创建一个新的字符串。</p>

<p>StringBuilder是可变类型，指为对象维护一个缓冲区以容纳字符串的扩展，如果空间可用，会把新数据追加到缓冲区，否则会分配一个新的更大缓冲区。将通常比 String 类提供更好的性能。</p>

<p>使用 String 类型的建议：</p>

<ul>
  <li>字符串更改数量很小</li>
  <li>固定数量的字符串串联操作</li>
  <li>对字符串执行大量搜索操作（StringBuilder缺少搜索方法）</li>
</ul>

<p>使用 StringBuilder 类型的建议：</p>

<ul>
  <li>对字符串进行未知数量的更改</li>
  <li>希望对字符串进行大量更改时</li>
</ul>

<h3 id="特性-obsolete-方法弃用提示">[特性] Obsolete 方法弃用提示</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="cm">/*在方法上加obsolete关键字可以标记该方法被弃用,标记弃用的方法仍可调用
如不允许再次调用，在()中加上判断 true ,加上后，调用时程序会报错 */</span>
<span class="p">[</span><span class="nf">Obsolete</span><span class="p">(</span><span class="s">"this method is obsolete, pls use NewMethod."</span><span class="p">,</span><span class="k">true</span><span class="p">)]</span>
<span class="k">static</span> <span class="k">void</span> <span class="nf">OldMethod</span><span class="p">(){}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="特性-conditional-控制方法的调用">[特性] Conditional 控制方法的调用</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="cm">/*Conditional关键字控制方法的调用
在文件头用宏（一些组织在一起的命令作为一个单独命令完成一个特定任务）定义一个规则 */</span>
<span class="cp">#define IsTest
</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">namespace</span> <span class="nn">MySpace</span>
<span class="p">{</span>
  <span class="k">class</span> <span class="nc">Program</span>
  <span class="p">{</span>
    <span class="p">[</span><span class="nf">Conditional</span><span class="p">(</span><span class="s">"IsTest"</span><span class="p">)]</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Method1</span><span class="p">(){}</span>
    
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nf">Method1</span><span class="p">();</span> <span class="c1">//系统调用时会检查宏是否有对应关键字，如有，则运行该方法，没有则不运行</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="特性-debuggerstepthrough-在调试时跳过该方法">[特性] DebuggerStepThrough 在调试时跳过该方法</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c1">//在方法头加上 DebuggerStepThrough 标签，debug step时可跳过该方法</span>
<span class="p">[</span><span class="n">DebuggerStepThrough</span><span class="p">]</span>
<span class="k">static</span> <span class="k">void</span> <span class="nf">Method1</span><span class="p">(){}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="创建自己的特性类自定义标签">创建自己的特性类(自定义标签)</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c1">//特性类是一个类，一般命名以Attribute结尾，且继承自System.Attribute,特性不需要继承，可以设计为封闭的 sealed</span>
<span class="p">[</span><span class="nf">AttributeUsage</span><span class="p">(</span><span class="n">AttributeTargets</span><span class="p">.</span><span class="n">Class</span><span class="p">)]</span> <span class="c1">//在特性类上方加标签说明特性可以用在什么类型的元素上，class或mathod或其他</span>
<span class="k">sealed</span> <span class="k">class</span> <span class="nc">MyTestAttribute</span><span class="p">:</span><span class="n">System</span><span class="p">.</span><span class="n">Attribute</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="kt">string</span> <span class="n">Description</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="正则表达式">正则表达式</h2>

<p>要在项目中引用<code class="language-plaintext highlighter-rouge">System.Text.RegularExpressions;</code>命名空间</p>

<p>关键字 <code class="language-plaintext highlighter-rouge">Regex</code></p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kt">string</span> <span class="n">st</span> <span class="p">=</span> <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span> <span class="c1">//接收用户输入的字符串</span>
<span class="kt">string</span> <span class="n">pattern</span> <span class="p">=</span> <span class="s">@"^\d*$"</span><span class="p">;</span> <span class="c1">//用正则表达式定义验证规则，此例为"输入只能是数字",用@让 \保持原意，不要转义，此处加@表示 \d 的原意，字符串中的"\"的原意是转义符，如果不用@，会把 \ 和 d 分开看</span>
<span class="kt">bool</span> <span class="n">isMatcth</span> <span class="p">=</span>  <span class="n">Regex</span><span class="p">.</span><span class="nf">IsMatch</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">pattern</span><span class="p">);</span> <span class="c1">//判断是否匹配，输出 bool</span>

<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">isMatcth</span> <span class="p">?</span> <span class="s">"It's true."</span> <span class="p">:</span> <span class="s">"Just allow number."</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="c1">// 检测用户的输入是否合法</span>
<span class="k">using</span> <span class="nn">System.Text.RegularExpressions</span><span class="p">;</span>

<span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">string</span> <span class="n">st</span> <span class="p">=</span> <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
  <span class="kt">string</span> <span class="n">pattern</span> <span class="p">=</span> <span class="s">@"^\d*$"</span><span class="p">;</span>
  <span class="kt">bool</span> <span class="n">isMatcth</span> <span class="p">=</span> <span class="n">Regex</span><span class="p">.</span><span class="nf">IsMatch</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">pattern</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">isMatcth</span> <span class="p">==</span> <span class="k">true</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"is true"</span><span class="p">);</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"is false,please try again"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">string</span> <span class="n">st</span> <span class="p">=</span> <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
  <span class="kt">string</span> <span class="n">pattern</span> <span class="p">=</span> <span class="s">@"^\d*$"</span><span class="p">;</span>
  <span class="kt">string</span> <span class="n">patternSearch</span> <span class="p">=</span> <span class="s">@"\d|[a-z]"</span><span class="p">;</span>
  <span class="kt">string</span> <span class="n">patternSplit</span> <span class="p">=</span> <span class="s">"[,;.]"</span><span class="p">;</span>
  <span class="c1">// 用 match 来找出用户输入字符串里合法字符,使用 Matches 来输入一个匹配 patternSearch 规则的list,类型为 Match</span>
  <span class="n">MatchCollection</span> <span class="n">coll</span> <span class="p">=</span> <span class="n">Regex</span><span class="p">.</span><span class="nf">Matches</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">patternSearch</span><span class="p">);</span>
  <span class="c1">// 定义一个字符串数组把按 patternSplit 的规则切分好的数据存入</span>
  <span class="kt">string</span><span class="p">[]</span> <span class="n">stSplit</span> <span class="p">=</span> <span class="n">Regex</span><span class="p">.</span><span class="nf">Split</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">patternSplit</span><span class="p">);</span> 
  <span class="k">foreach</span> <span class="p">(</span><span class="n">Match</span> <span class="n">match</span> <span class="k">in</span> <span class="n">coll</span><span class="p">)</span>
  <span class="p">{</span>
  		<span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">match</span> <span class="p">+</span> <span class="s">" "</span><span class="p">);</span> <span class="c1">//把符合条件的字符输出</span>
  <span class="p">}</span> 
  
  <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">str</span> <span class="k">in</span> <span class="n">stSplit</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">str</span> <span class="p">+</span> <span class="s">" "</span><span class="p">);</span> <span class="c1">//把切分的字符输出</span>
	<span class="p">}</span>
  
  <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="委托和-lambda">委托和 Lambda</h2>

<p>关键字 <code class="language-plaintext highlighter-rouge">delegate</code>，委托用于将<strong>方法</strong>作为参数传递给其他方法。<strong>定义一个委托相当于定义一个新类。</strong></p>

<p>一旦声明了委托类型，委托对象必须使用 <strong>new</strong> 关键字来创建，且与一个特定的<strong>方法</strong>有关。</p>

<p>定义委托：<code class="language-plaintext highlighter-rouge">delegate 返回值 方法名（参数）;</code></p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="c1">//定义委托,如果被委托的方法中指定了输入参数，委托中也有要同类型参数</span>
<span class="k">public</span> <span class="k">delegate</span> <span class="k">void</span> <span class="nf">PrintString</span><span class="p">(</span><span class="kt">string</span> <span class="n">str</span><span class="p">);</span>

<span class="c1">//定义一个方法</span>
<span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">WriteToScreen</span><span class="p">(</span><span class="kt">string</span> <span class="n">str</span><span class="p">)</span> <span class="c1">//需要和委托一样有一个输入参数</span>
<span class="p">{</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"The string is </span><span class="p">{</span><span class="n">str</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Write</span><span class="p">(</span><span class="kt">string</span> <span class="n">str</span><span class="p">)</span> <span class="c1">//需要和委托一样有一个输入参数</span>
<span class="p">{</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"The write is </span><span class="p">{</span><span class="n">str</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">string</span> <span class="n">x</span> <span class="p">=</span> <span class="s">"you"</span><span class="p">;</span>
  <span class="c1">//把方法做为值赋给委托</span>
  <span class="n">PrintString</span> <span class="n">pst</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PrintString</span><span class="p">(</span><span class="n">WriteToScreen</span><span class="p">);</span>
  <span class="n">PrintString</span> <span class="n">pst</span> <span class="p">=</span> <span class="n">WriteToScreen</span><span class="p">;</span> <span class="c1">//上一行的简化方式，直接把方法赋值给委托的变量</span>
  <span class="n">PrintString</span> <span class="n">pst1</span> <span class="p">=</span> <span class="n">Write</span><span class="p">;</span>
  
  <span class="nf">pst</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="c1">//output:The string is you</span>
  <span class="nf">pst1</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="c1">// output:The write is you</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="action委托没有返回值">Action委托(没有返回值)</h3>

<p>Action委托是系统内置的委托类型。</p>

<ul>
  <li>Action 委托只能指向一个没有参数，<strong>没有返回值</strong>的方法。</li>
  <li><code class="language-plaintext highlighter-rouge">Action&lt;T&gt;</code>封装一个方法，该方法只有一个参数 T 且没有返回值。</li>
  <li><code class="language-plaintext highlighter-rouge">Action&lt;int,int string&gt;</code>   可以有多个参数，最多支持16个，委托和被委托的参数类型及个数要对应。</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="k">static</span> <span class="k">void</span> <span class="nf">PrintString</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"hello"</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">stratic</span> <span class="k">void</span> <span class="nf">StringValue</span><span class="p">(</span><span class="kt">string</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"this is  </span><span class="p">{</span><span class="n">x</span><span class="p">}</span><span class="s"> Action."</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">string</span> <span class="n">y</span> <span class="p">=</span> <span class="s">"you"</span><span class="p">;</span>
  <span class="n">Action</span> <span class="n">a</span> <span class="p">=</span> <span class="n">PrintString</span><span class="p">;</span>
  <span class="n">Action</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">=</span> <span class="n">StringValue</span><span class="p">;</span>
  <span class="nf">a</span><span class="p">();</span> <span class="c1">// output:hello</span>
  <span class="nf">action</span><span class="p">(</span><span class="n">y</span><span class="p">);</span> <span class="c1">// output:this is a you Action</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="func委托必须有返回值">Func委托（必须有返回值）</h3>

<p>Func委托要求指向的方法<strong>必须有返回值</strong>，可以传递0个到16个参数类型，和1个返回类型。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="k">static</span> <span class="kt">int</span> <span class="nf">Test1</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">ruturn</span> <span class="m">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Test2</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">string</span> <span class="n">y</span> <span class="p">=</span> <span class="s">"hi"</span><span class="p">;</span>
  <span class="kt">string</span> <span class="n">z</span> <span class="p">=</span> <span class="n">x</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
  <span class="k">return</span> <span class="n">y</span> <span class="p">+</span> <span class="s">" "</span> <span class="p">+</span> <span class="n">z</span><span class="p">;</span> <span class="c1">//返回值是string类型</span>
<span class="p">}</span>
<span class="n">Func</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">a</span> <span class="p">=</span> <span class="n">Test1</span><span class="p">;</span> <span class="c1">// 返回类型为 int</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">()</span>
<span class="n">Func</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">b</span> <span class="p">=</span> <span class="n">Test2</span><span class="p">;</span> <span class="c1">//&lt; &gt;中有多个值时，最后一个表示返回类型，前面所有都表示参数类型,必须和指向的方法一一对应。相当于 Func&lt;in int, out string&gt;</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="nf">Text2</span><span class="p">(</span><span class="m">2</span><span class="p">));</span> <span class="c1">// output:hi 2</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="多播委托">多播委托</h3>

<p>委托多个对象。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c1">//用+=来连接多个委托</span>
<span class="k">static</span> <span class="k">void</span> <span class="nf">Test1</span><span class="p">(){</span><span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Test1"</span><span class="p">)};</span>
<span class="k">static</span> <span class="k">void</span> <span class="nf">Test2</span><span class="p">(){</span><span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Test2"</span><span class="p">)};</span>
<span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(){</span>
  <span class="n">Action</span> <span class="n">a</span> <span class="p">=</span> <span class="n">Test1</span><span class="p">;</span>
		<span class="n">a</span> <span class="p">+=</span> <span class="n">Test2</span><span class="p">;</span> <span class="c1">//means a = Test1 + Test2</span>
  	<span class="n">a</span> <span class="p">-=</span> <span class="n">Test1</span><span class="p">;</span> <span class="c1">//means a = Test2</span>
	<span class="nf">a</span><span class="p">();</span> <span class="c1">// output:Test1 Test2</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="匿名方法">匿名方法</h3>

<p>在创建委托时创建一个没有名字的方法。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">Func</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">a</span> <span class="p">=</span> <span class="k">delegate</span><span class="p">(</span><span class="kt">int</span> <span class="n">arg1</span><span class="p">,</span><span class="kt">int</span> <span class="n">arg2</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="n">arg1</span> <span class="p">+</span> <span class="n">arg2</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="lambda">Lambda</h3>

<p>lambda表达式是用来简化匿名方法的。</p>

<p>lambda表达式不需要声明参数类型。</p>

<p>当参数只有一个时，可以不写小括号，当方法体只有一句时可以不写大括号。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">Func</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">a</span> <span class="p">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span><span class="n">arg2</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span><span class="k">return</span> <span class="n">arg1</span> <span class="p">+</span> <span class="n">arg2</span><span class="p">;};</span>
<span class="n">Func</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">a</span> <span class="p">=</span> <span class="n">arg1</span> <span class="p">=&gt;</span> <span class="n">a</span><span class="p">+</span><span class="m">1</span><span class="p">;</span> <span class="c1">//23表示返回值，即return = a+1</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="事件">事件</h3>

<p>事件基于委托，为委托提供了一个发布/订阅机制，可以说是特殊的委托。</p>

<p><strong>事件不能在类的外部触发，只能在类的内部调用。</strong></p>

<p>格式：<code class="language-plaintext highlighter-rouge">public event 委托类型 事件名</code></p>

<ul>
  <li>动作触发者发布消息</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="n">Class</span> <span class="n">Teacher</span>
<span class="p">{</span>
  			<span class="c1">//基本属性</span>
  			<span class="k">private</span> <span class="kt">string</span> <span class="n">name</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">course</span><span class="p">;</span>
				<span class="c1">//构造方法</span>
        <span class="k">public</span> <span class="nf">Teacher</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span><span class="kt">string</span> <span class="n">course</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="n">name</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">course</span> <span class="p">=</span> <span class="n">course</span><span class="p">;</span>
        <span class="p">}</span>
				<span class="c1">//定义动作</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">WhoseCourse</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">'s class is </span><span class="p">{</span><span class="n">course</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
          	<span class="c1">//调用事件 TeacherCourse</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">TeacherCourse</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="nf">TeacherCourse</span><span class="p">();</span>
        <span class="p">}</span>
				<span class="c1">//定义事件（广播），发布信息,使用 event 关键字让action委托只能在类的内部触发，避免外部调用，减少误调用而出错</span>
        <span class="k">public</span> <span class="k">event</span> <span class="n">Action</span> <span class="n">TeacherCourse</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>接收者订阅（注册）消息</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">student</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">name</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">sex</span><span class="p">;</span>
				<span class="c1">// 把Teacher类做为参数传入</span>
        <span class="k">public</span> <span class="nf">student</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span><span class="kt">string</span> <span class="n">sex</span><span class="p">,</span><span class="n">Teacher</span> <span class="n">teacher</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="n">name</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">sex</span> <span class="p">=</span> <span class="n">sex</span><span class="p">;</span>
          	<span class="c1">//把ChooseCourse事件传给teacher里的event委托(订阅消息)</span>
            <span class="n">teacher</span><span class="p">.</span><span class="n">TeacherCourse</span> <span class="p">+=</span> <span class="n">ChooseCourse</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">ChooseCourse</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s"> choose (</span><span class="p">{</span><span class="n">sex</span><span class="p">}</span><span class="s">)."</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>实例化</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Teacher</span> <span class="n">teacher1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Teacher</span><span class="p">(</span><span class="s">"Marry"</span><span class="p">,</span> <span class="s">"Math"</span><span class="p">);</span>
            <span class="n">Teacher</span> <span class="n">teacher2</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Teacher</span><span class="p">(</span><span class="s">"Emma"</span><span class="p">,</span> <span class="s">"Music"</span><span class="p">);</span>
            <span class="n">student</span> <span class="n">student1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">student</span><span class="p">(</span><span class="s">"Tom"</span><span class="p">,</span> <span class="s">"boy"</span><span class="p">,</span> <span class="n">teacher1</span><span class="p">);</span>
            <span class="n">student</span> <span class="n">student2</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">student</span><span class="p">(</span><span class="s">"Lily"</span><span class="p">,</span> <span class="s">"girl"</span><span class="p">,</span> <span class="n">teacher2</span><span class="p">);</span>
            <span class="c1">//调用Teacher中的动作，此时会把Student里的动作也调用上</span>
          	<span class="n">teacher1</span><span class="p">.</span><span class="nf">WhoseCourse</span><span class="p">();</span>
            <span class="n">teacher2</span><span class="p">.</span><span class="nf">WhoseCourse</span><span class="p">();</span>
        <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="排序的拓展方法适用于任何类型的排序">排序的拓展方法（适用于任何类型的排序）</h2>

<p>以给雇员薪水排序为例。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
</pre></td><td class="rouge-code"><pre><span class="k">namespace</span> <span class="nn">C_Sharp_test</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Employee</span> <span class="c1">//定义一个自定义类，包含雇员的名字和薪水</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Salary</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">public</span> <span class="nf">Employee</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">salary</span><span class="p">)</span> <span class="c1">//构造方法</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">Name</span> <span class="p">=</span> <span class="n">name</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">Salary</span> <span class="p">=</span> <span class="n">salary</span><span class="p">;</span>
        <span class="p">}</span>
				<span class="c1">//定义一个布尔方法</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">Compare</span><span class="p">(</span><span class="n">Employee</span> <span class="n">e1</span><span class="p">,</span> <span class="n">Employee</span> <span class="n">e2</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">e1</span><span class="p">.</span><span class="n">Salary</span> <span class="p">&gt;</span> <span class="n">e2</span><span class="p">.</span><span class="n">Salary</span><span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
				<span class="c1">//重写该类中的ToString方法，把输出值更换为想要的输出值</span>
        <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="nf">ToString</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">Name</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">Salary</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
      	<span class="cm">/* 定义一个通用的比较方法（泛型）
      	返回值未知&lt;T&gt;，属性：
      	in:一个名为 dataArray 的未知类型T的数组
      	out:一个名为 compareMethod 的 Func&lt;T,T,bool&gt; 委托 */</span>
        <span class="k">static</span> <span class="k">void</span> <span class="n">CommonSort</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">T</span><span class="p">[]</span> <span class="n">dataArray</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="kt">bool</span><span class="p">&gt;</span> <span class="n">compareMethod</span><span class="p">)</span>
        <span class="p">{</span>
          	<span class="c1">//冒泡排序方法，参考 basic1 中的冒泡排序法</span>
            <span class="kt">bool</span> <span class="n">swapped</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="k">do</span>
            <span class="p">{</span>
                <span class="n">swapped</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">dataArray</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
                <span class="p">{</span>
                   	<span class="cm">/* 
                   	if条件中默认为true，此处原方法为比较int类型中的字符
                   	dataArray[i + 1] &lt; dataArray[i] = true
                   	用Func&lt;T,T,bool&gt;委托，输入两个未知类型的值T,返回 bool = true 给 if
                   	*/</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nf">compareMethod</span><span class="p">(</span><span class="n">dataArray</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dataArray</span><span class="p">[</span><span class="n">i</span> <span class="p">+</span> <span class="m">1</span><span class="p">]))</span>
                    <span class="p">{</span>
                        <span class="n">T</span> <span class="n">temp</span> <span class="p">=</span> <span class="n">dataArray</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="c1">//原来的int temp --&gt; T temp 未知类型的值</span>
                        <span class="n">dataArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">dataArray</span><span class="p">[</span><span class="n">i</span> <span class="p">+</span> <span class="m">1</span><span class="p">];</span>
                        <span class="n">dataArray</span><span class="p">[</span><span class="n">i</span> <span class="p">+</span> <span class="m">1</span><span class="p">]</span> <span class="p">=</span> <span class="n">temp</span><span class="p">;</span>
                        <span class="n">swapped</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">swapped</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">//用Employee类实例化一个新的数组，数组中每个值名称为 Employee ,类型为 function ,值为方法中的赋值</span>
            <span class="n">Employee</span><span class="p">[]</span> <span class="n">employees</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Employee</span><span class="p">[]</span>
            <span class="p">{</span>
              	<span class="c1">//实例化Employee方法</span>
                <span class="k">new</span> <span class="nf">Employee</span><span class="p">(</span><span class="s">"baku"</span><span class="p">,</span><span class="m">612</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">Employee</span><span class="p">(</span><span class="s">"saku"</span><span class="p">,</span><span class="m">132</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">Employee</span><span class="p">(</span><span class="s">"taku"</span><span class="p">,</span> <span class="m">212</span><span class="p">),</span>
            <span class="p">};</span>
						<span class="cm">/*实例化泛型比较方法，返回值&lt;Employee&gt;
						传入参数为实例化数组 employees
						返回参数为 Employee 类中 Compare 方法的 bool 值 */</span>
            <span class="n">CommonSort</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;(</span><span class="n">employees</span><span class="p">,</span> <span class="n">Employee</span><span class="p">.</span><span class="n">Compare</span><span class="p">);</span>
            <span class="k">foreach</span><span class="p">(</span><span class="n">Employee</span> <span class="n">em</span> <span class="k">in</span> <span class="n">employees</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="cm">/*遍历数组，返回 Employee 方法所在的类名（Employee），因为方法定义的返回值为 Employee 类
              	ToString为系统内置方法，ToString默认返回值为（return base.ToString）,即所属 class 的类型。
              	把ToString方法重写为想要的输出值：
              	return Name + ":" + Salary;
              	WriteLine会默认调用ToString方法，输入字符串，所以直接wirteline em即可
              	也可以调用ToString方法 Console.WriteLine(em.ToString()); */</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">em</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="linq查询">LINQ查询</h2>

<p>.NET 中的集成查询技术。</p>

<p>操作步骤：</p>

<ol>
  <li>获取数据源</li>
  <li>创建查询</li>
  <li>执行查询</li>
</ol>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c1">//获取数据源list, m 代表数据源列表中的对象</span>
<span class="kt">var</span> <span class="n">IntList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;()</span> <span class="p">{</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">56</span><span class="p">,</span> <span class="m">22</span> <span class="p">};</span>
<span class="kt">var</span> <span class="n">res</span> <span class="p">=</span> <span class="k">from</span> <span class="n">m</span> <span class="k">in</span> <span class="n">IntList</span> 
  				<span class="k">where</span> <span class="n">m</span> <span class="p">&gt;</span><span class="m">8</span> <span class="c1">//查询条件,没有查询条件可不写这句</span>
  				<span class="k">select</span> <span class="n">m</span><span class="p">;</span> <span class="c1">//把符合条件的对象返回</span>
<span class="c1">//输出</span>
<span class="k">foreach</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="k">in</span> <span class="n">res</span><span class="p">){</span><span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">i</span><span class="p">);}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="查询复杂list对象">查询复杂list对象</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="c1">//建立对象类</span>
<span class="k">class</span> <span class="nc">Student</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">Age</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">FavoriteCourse</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="c1">//把对象转为字符串</span>
  <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="nf">ToString</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">$"ID:</span><span class="p">{</span><span class="n">Id</span><span class="p">}</span><span class="s">,Name:</span><span class="p">{</span><span class="n">Name</span><span class="p">}</span><span class="s">,Age:</span><span class="p">{</span><span class="n">Age</span><span class="p">}</span><span class="s">,FavoriteCourse:</span><span class="p">{</span><span class="n">FavoriteCourse</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Teacher</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">Course</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="c1">//把对象转为字符串</span>
  <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="nf">ToString</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">$"ID:</span><span class="p">{</span><span class="n">Id</span><span class="p">}</span><span class="s">,Name:</span><span class="p">{</span><span class="n">Name</span><span class="p">}</span><span class="s">,Course:</span><span class="p">{</span><span class="n">Course</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>单表查询</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="c1">//初始化列表对象</span>
<span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
  <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="kt">var</span> <span class="n">StudentList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Student</span><span class="p">&gt;()</span>
    <span class="p">{</span>
      <span class="k">new</span> <span class="nf">student</span><span class="p">()</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"e"</span><span class="p">,</span> <span class="n">Age</span> <span class="p">=</span> <span class="m">1</span> <span class="p">,</span><span class="n">FavoriteCourse</span> <span class="p">=</span> <span class="s">"Math"</span><span class="p">},</span>
      <span class="k">new</span> <span class="nf">student</span><span class="p">()</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"a"</span><span class="p">,</span> <span class="n">Age</span> <span class="p">=</span> <span class="m">2</span> <span class="p">,</span><span class="n">FavoriteCourse</span> <span class="p">=</span> <span class="s">"Music"</span><span class="p">},</span>
    <span class="p">};</span>
    <span class="kt">var</span> <span class="n">TeacherList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Teacher</span><span class="p">&gt;()</span>
    <span class="p">{</span>
      <span class="k">new</span> <span class="nf">teacher</span><span class="p">()</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"e"</span><span class="p">,</span> <span class="n">Age</span> <span class="p">=</span> <span class="m">1</span> <span class="p">,</span> <span class="n">Course</span> <span class="p">=</span> <span class="s">"Math"</span> <span class="p">},</span>
      <span class="k">new</span> <span class="nf">teacher</span><span class="p">()</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"a"</span><span class="p">,</span> <span class="n">Age</span> <span class="p">=</span> <span class="m">2</span> <span class="p">,</span> <span class="n">Course</span> <span class="p">=</span> <span class="s">"Music"</span> <span class="p">},</span>
    <span class="p">};</span>
    
    <span class="c1">//查询</span>
    <span class="kt">var</span> <span class="n">res</span> <span class="p">=</span> <span class="k">from</span> <span class="n">m</span> <span class="k">in</span> <span class="n">StudentList</span>
      				<span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">1</span>
      				<span class="k">select</span> <span class="n">m</span><span class="p">;</span>
    
    <span class="c1">//输出查询结果</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="k">in</span> <span class="n">res</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>对单表结果按条件分组 group by</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="kt">var</span> <span class="n">res</span> <span class="p">=</span> <span class="k">from</span> <span class="n">m</span> <span class="k">in</span> <span class="n">StudentList</span>
  				<span class="k">group</span> <span class="n">m</span> <span class="k">in</span> <span class="n">m</span><span class="p">.</span><span class="n">FavoriteCourse</span> <span class="k">into</span> <span class="n">newGroup</span> <span class="c1">//按FavoriteCourse分组</span>
  				<span class="k">orderby</span> <span class="n">newGroup</span><span class="p">.</span><span class="n">Key</span> <span class="c1">//newGroup.key=m.favoritecourse</span>
  				<span class="k">select</span> <span class="k">new</span> <span class="p">{</span><span class="n">fvcourse</span> <span class="p">=</span> <span class="n">newGroup</span><span class="p">.</span><span class="n">key</span><span class="p">,</span><span class="n">count</span> <span class="p">=</span> <span class="n">newGroup</span><span class="p">.</span><span class="nf">Count</span><span class="p">()};</span>

<span class="c1">//输出查询结果</span>
<span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">temp</span> <span class="k">in</span> <span class="n">res</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">temp</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>用 .any判断是否包含元素或存在元素满足指定条件</p>

<p>用 .all判断序列是否完全满足指定条件</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c1">//是否存在满足条件的元素</span>
<span class="kt">bool</span> <span class="n">res</span> <span class="p">=</span> <span class="n">StudentList</span><span class="p">.</span><span class="nf">Any</span><span class="p">(</span><span class="n">m</span> <span class="p">=&gt;</span> <span class="n">m</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">1</span><span class="p">);</span>
<span class="c1">//是否序列所有元素都满足条件</span>
<span class="kt">bool</span> <span class="n">res</span> <span class="p">=</span> <span class="n">StudentList</span><span class="p">.</span><span class="nf">All</span><span class="p">(</span><span class="n">m</span> <span class="p">=&gt;</span> <span class="n">m</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">1</span><span class="p">);</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">res</span><span class="p">);</span> <span class="c1">//output:True</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>多表查询（联合查询）</p>

<p>联合查询会把第一个序列和第二个序列中所有元素合并成一个序列</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kt">var</span> <span class="n">res</span> <span class="p">=</span> <span class="k">from</span> <span class="n">s</span> <span class="k">in</span> <span class="n">StudentList</span>
  				<span class="k">from</span> <span class="n">t</span> <span class="k">in</span> <span class="n">TeacherList</span>
  				<span class="k">where</span> <span class="n">s</span><span class="p">.</span><span class="n">FavoriteCourse</span> <span class="p">==</span> <span class="n">t</span><span class="p">.</span><span class="n">Course</span>
  				<span class="k">orderby</span> <span class="n">s</span><span class="p">.</span><span class="n">Age</span> <span class="k">descending</span>  <span class="c1">//排序关键字 orderby,倒序 descending</span>
  				<span class="c1">//orderby s.Age,t.Age 多字段排序</span>
  				<span class="k">select</span> <span class="k">new</span> <span class="p">{</span><span class="n">student</span> <span class="p">=</span> <span class="n">m</span><span class="p">,</span> <span class="n">teacher</span> <span class="p">=</span> <span class="n">k</span><span class="p">};</span>

<span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">human</span> <span class="k">in</span> <span class="n">res</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">human</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>另一种联合方法 join in，把结果分类</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kt">var</span> <span class="n">res</span> <span class="p">=</span> <span class="k">from</span> <span class="n">s</span> <span class="k">in</span> <span class="n">StudentList</span>
  				<span class="k">join</span> <span class="n">t</span> <span class="k">in</span> <span class="n">TeacherList</span>
  				<span class="k">on</span> <span class="n">s</span><span class="p">.</span><span class="n">FavoriteCourse</span> <span class="k">equals</span> <span class="n">t</span><span class="p">.</span><span class="n">Course</span>
  				<span class="k">into</span> <span class="n">groups</span> <span class="c1">//把结果放到一个组中</span>
  				<span class="k">orderby</span> <span class="n">groups</span><span class="p">.</span><span class="nf">Count</span><span class="p">()</span> <span class="c1">//按统计排序</span>
  				<span class="k">select</span> <span class="k">new</span> <span class="p">{</span><span class="n">student</span> <span class="p">=</span> <span class="n">m</span><span class="p">,</span> <span class="n">count</span> <span class="p">=</span> <span class="n">groups</span><span class="p">.</span><span class="nf">Count</span><span class="p">()};</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="文件操作">文件操作</h2>

<h3 id="文件属性读取操作">文件属性读取操作</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">FileInfo</span> <span class="n">fileInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">FileInfo</span><span class="p">(</span><span class="s">"filename.txt"</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">fileInfo</span><span class="p">.</span><span class="n">Exists</span> <span class="p">==</span> <span class="k">false</span><span class="p">){</span><span class="n">fileInfo</span><span class="p">.</span><span class="nf">Create</span><span class="p">();}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="文件夹属性读取操作">文件夹属性读取操作</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">DirectoryInfo</span> <span class="n">dirInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DirectoryInfo</span><span class="p">(</span><span class="s">"directoryname"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="文件内容读写">文件内容读写</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre><span class="c1">//读取文本文件</span>
<span class="kt">string</span><span class="p">[]</span> <span class="n">strArray</span> <span class="p">=</span> <span class="n">File</span><span class="p">.</span><span class="nf">ReadLines</span><span class="p">(</span><span class="s">"fileName.txt"</span><span class="p">);</span>
<span class="c1">//适合读取二进制文件</span>
<span class="n">FileStream</span> <span class="n">stream</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">FileStream</span><span class="p">(</span><span class="s">"file.txt"</span><span class="p">,</span><span class="n">FileMode</span><span class="p">.</span><span class="n">Open</span><span class="p">);</span>
<span class="c1">//最常用于读取文本文件的方式,不需要声明文件的编码，此命令会自动处理</span>
<span class="n">StreamReader</span> <span class="n">str</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="s">"filename.txt"</span><span class="p">);</span>
<span class="n">StreamReader</span> <span class="n">str</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="s">"filename.txt"</span><span class="p">,</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">);</span>

<span class="c1">//写入文本文件</span>
<span class="n">StreamWriter</span> <span class="n">writer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamWriter</span><span class="p">(</span><span class="s">"filename.txt"</span><span class="p">);</span><span class="c1">//如果不存在此文件会自动新建,如果存在会覆盖同名文件</span>

<span class="c1">//输出读取结果方法1</span>
<span class="nf">While</span><span class="p">(</span><span class="k">true</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">string</span> <span class="n">str</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span> <span class="c1">//读取一行字符串</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">str</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">//输出读取结果方法2</span>
<span class="kt">string</span> <span class="n">str</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="n">str</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>

<span class="c1">//输出StreamWriter的写入结果</span>
<span class="k">while</span><span class="p">(</span><span class="k">true</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">string</span> <span class="n">message</span> <span class="p">=</span> <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">messsage</span> <span class="p">==</span> <span class="s">"q"</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span> <span class="c1">//设置退出写入的命令键</span>
  <span class="n">writer</span><span class="p">.</span><span class="nf">WriterLine</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">writer</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="xml--json">XML  JSON</h2>

<h3 id="xml">XML</h3>

<ul>
  <li>xml 必须要有开头结尾符</li>
  <li>标签可以加属性，属性名和属性值都可自定义</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;skills&gt;</span>
    <span class="nt">&lt;skill&gt;</span>
        <span class="nt">&lt;id&gt;</span>1<span class="nt">&lt;/id&gt;</span>
      	<span class="c">&lt;!--属性名为 lang ，值为 eng--&gt;</span>
        <span class="nt">&lt;name</span> <span class="na">lang=</span><span class="s">"eng"</span><span class="nt">&gt;</span>sky<span class="nt">&lt;/name&gt;</span> 
        <span class="nt">&lt;damage&gt;</span>123<span class="nt">&lt;/damage&gt;</span>
    <span class="nt">&lt;/skill&gt;</span>

    <span class="nt">&lt;skill&gt;</span>
        <span class="nt">&lt;id&gt;</span>2<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;name</span> <span class="na">lang=</span><span class="s">"eng"</span><span class="nt">&gt;</span>ground<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;damage&gt;</span>12<span class="nt">&lt;/damage&gt;</span>
    <span class="nt">&lt;/skill&gt;</span>
<span class="nt">&lt;/skills&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>读取</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Skill</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="k">public</span> <span class="kt">string</span> <span class="n">Lang</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">Damage</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
  <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="c1">//位于 System.Xml 类下</span>
    <span class="n">XmlDocument</span> <span class="n">xmlDoc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">XmlDocument</span><span class="p">();</span>
    <span class="n">xmlDoc</span><span class="p">.</span><span class="nf">Load</span><span class="p">(</span><span class="s">"skillinfo.txt"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="json">json</h3>

<p><img src="/note_other/post/Code/C_Sharp/C_Sharp/C_Sharp_basic2.assets/object.png" alt="img" /></p>

<p><img src="/note_other/post/Code/C_Sharp/C_Sharp/C_Sharp_basic2.assets/array.png" alt="img" /></p>

<p><img src="/note_other/post/Code/C_Sharp/C_Sharp/C_Sharp_basic2.assets/value.png" alt="img" /></p>

<p><img src="/note_other/post/Code/C_Sharp/C_Sharp/C_Sharp_basic2.assets/string.png" alt="img" /></p>

<p><img src="/note_other/post/Code/C_Sharp/C_Sharp/C_Sharp_basic2.assets/number.png" alt="img" /></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="err">//json文件-array</span><span class="w"> 
</span><span class="p">[</span><span class="w">
</span><span class="p">{</span><span class="nl">"id"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"aa"</span><span class="p">,</span><span class="nl">"damage"</span><span class="p">:</span><span class="mi">123</span><span class="p">},</span><span class="w">
</span><span class="p">{</span><span class="nl">"id"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"bb"</span><span class="p">,</span><span class="nl">"damage"</span><span class="p">:</span><span class="mi">13</span><span class="p">},</span><span class="w">
</span><span class="p">{</span><span class="nl">"id"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"cc"</span><span class="p">,</span><span class="nl">"damage"</span><span class="p">:</span><span class="mi">12</span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">//json文件-object</span>
<span class="p">{</span>
  <span class="s">"Name"</span><span class="p">:</span><span class="s">"baku"</span><span class="p">,</span>
  <span class="s">"Level"</span><span class="p">:</span><span class="m">99</span><span class="p">,</span>
  <span class="s">"Age"</span><span class="p">:</span><span class="m">14</span><span class="p">,</span>
  <span class="s">"SkillList"</span><span class="p">:</span>
  <span class="p">[</span>
    <span class="p">{</span><span class="s">"id"</span><span class="p">:</span><span class="m">2</span><span class="p">,</span><span class="s">"name"</span><span class="p">:</span><span class="s">"aa"</span><span class="p">,</span><span class="s">"damage"</span><span class="p">:</span><span class="m">123</span><span class="p">},</span>
    <span class="p">{</span><span class="s">"id"</span><span class="p">:</span><span class="m">3</span><span class="p">,</span><span class="s">"name"</span><span class="p">:</span><span class="s">"bb"</span><span class="p">,</span><span class="s">"damage"</span><span class="p">:</span><span class="m">13</span><span class="p">},</span>
    <span class="p">{</span><span class="s">"id"</span><span class="p">:</span><span class="m">4</span><span class="p">,</span><span class="s">"name"</span><span class="p">:</span><span class="s">"cc"</span><span class="p">,</span><span class="s">"damage"</span><span class="p">:</span><span class="m">12</span><span class="p">}</span>
	<span class="p">]</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="用-litjson-解析json">用 LitJson 解析Json</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">LitJson</span><span class="p">;</span>
<span class="c1">//右键项目-管理NuGet包-LitJson,添加包</span>
<span class="c1">//JsonData 代表一个数组或一个对象,读取外部文件时，需要把外部文件的[属性]中[生成-复制到输出目录]选择为[如较新则复制]，不然文件无法被找到</span>
<span class="n">JsonData</span> <span class="n">jsonData</span> <span class="p">=</span> <span class="n">JsonMapper</span><span class="p">.</span><span class="nf">ToObject</span><span class="p">(</span><span class="n">File</span><span class="p">.</span><span class="nf">ReadAllText</span><span class="p">(</span><span class="s">"json.txt"</span><span class="p">));</span>

<span class="k">foreach</span> <span class="p">(</span><span class="n">JsonData</span> <span class="n">temp</span> <span class="k">in</span> <span class="n">jsonData</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">//通过key值查找value</span>
  <span class="n">JsonData</span> <span class="n">idvalue</span> <span class="p">=</span> <span class="n">temp</span><span class="p">[</span><span class="s">"id"</span><span class="p">];</span>
  <span class="n">JsonData</span> <span class="n">namevalue</span> <span class="p">=</span> <span class="n">temp</span><span class="p">[</span><span class="s">"name"</span><span class="p">];</span>
  
  <span class="c1">//把JsonData类型转换为相应可输出类型</span>
  <span class="kt">int</span> <span class="n">id</span> <span class="p">=</span> <span class="n">Int32</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">idvalue</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
  <span class="kt">string</span> <span class="n">name</span> <span class="p">=</span> <span class="n">namevalue</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
  
  <span class="c1">//输出结果</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">id</span><span class="p">}</span><span class="s">:</span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>把json数据用一个类来管理</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Skill</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
  <span class="k">public</span> <span class="kt">string</span> <span class="n">name</span><span class="p">;</span>
  <span class="k">public</span> <span class="kt">string</span> <span class="n">damage</span><span class="p">;</span>
  
  <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="nf">ToString</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">$"id:</span><span class="p">{</span><span class="n">id</span><span class="p">}</span><span class="s">,name:</span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">,damage:</span><span class="p">{</span><span class="n">damage</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="c1">//建一个列表存放json转化出来的数据</span>
    <span class="n">List</span><span class="p">&lt;</span><span class="n">Skill</span><span class="p">&gt;</span> <span class="n">skills</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Skill</span><span class="p">&gt;();</span>
    <span class="c1">//把Skill类中的对象实例化</span>
    <span class="n">Skill</span> <span class="n">skill</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Skill</span><span class="p">();</span>
    
    <span class="c1">//解析json文件</span>
    <span class="n">JsonData</span> <span class="n">jsonData</span> <span class="p">=</span>  <span class="n">JsonMapper</span><span class="p">.</span><span class="nf">ToObject</span><span class="p">(</span><span class="n">File</span><span class="p">.</span><span class="nf">ReadAllText</span><span class="p">(</span><span class="s">"json.txt"</span><span class="p">));</span>
    
    <span class="c1">//遍历json文件中的数据，转化为可读类型字段</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="n">Jsondata</span> <span class="n">temp</span> <span class="k">in</span> <span class="n">jsonData</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">JsonData</span> <span class="n">idValue</span> <span class="p">=</span> <span class="n">temp</span><span class="p">[</span><span class="s">"id"</span><span class="p">];</span> <span class="c1">//通过key得到value</span>
      <span class="n">JsonData</span> <span class="n">nameValue</span> <span class="p">=</span> <span class="n">temp</span><span class="p">[</span><span class="s">"name"</span><span class="p">];</span>
      
      <span class="n">skill</span><span class="p">.</span><span class="n">id</span> <span class="p">=</span> <span class="n">Int32</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">idValue</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span> <span class="c1">//把json值转成可读类型</span>
      <span class="n">skill</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="n">nameValue</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
      <span class="n">skills</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">skill</span><span class="p">);</span> <span class="c1">//把数据添加到列表中    </span>
    <span class="p">}</span>
    
    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">temp</span> <span class="k">in</span> <span class="n">skills</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">temp</span><span class="p">);</span> <span class="c1">//输出skills列表中的数据</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>用泛型解析json</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Skill</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
  <span class="k">public</span> <span class="kt">string</span> <span class="n">name</span><span class="p">;</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">damage</span><span class="p">;</span>
  
  <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="nf">ToString</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">$"id:</span><span class="p">{</span><span class="n">id</span><span class="p">}</span><span class="s">,name:</span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">,damage:</span><span class="p">{</span><span class="n">damage</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">//Object对象中嵌套list</span>
<span class="k">class</span> <span class="nc">SkillObject</span> 
<span class="p">{</span>
  <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">Level</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">Age</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Skill</span><span class="p">&gt;</span> <span class="n">SkillList</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
  
  <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="nf">ToString</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">$"name:</span><span class="p">{</span><span class="n">Name</span><span class="p">}</span><span class="s">,leve:</span><span class="p">{</span><span class="n">Level</span><span class="p">}</span><span class="s">,age:</span><span class="p">{</span><span class="n">Age</span><span class="p">}</span><span class="s">,skillList:</span><span class="p">{</span><span class="n">SkillList</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">MainClass</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="c1">//解析数组-使用这种方法需要Class Skill中的字段和json中的值完全一致</span>
    <span class="n">Skill</span><span class="p">[]</span> <span class="n">skillArray</span> <span class="p">=</span> <span class="n">JsonMapper</span><span class="p">.</span><span class="n">ToObject</span><span class="p">&lt;</span><span class="n">Skill</span><span class="p">[</span><span class="k">]&gt;</span><span class="p">(</span><span class="n">File</span><span class="p">.</span><span class="nf">ReadAllText</span><span class="p">(</span><span class="s">"json.txt"</span><span class="p">));</span>
    <span class="c1">//解析list-可以用list的方式代替泛型中的数组</span>
    <span class="n">List</span><span class="p">&lt;</span><span class="n">Skill</span><span class="p">&gt;</span> <span class="n">skillList</span> <span class="p">=</span> <span class="n">JsonMapper</span><span class="p">.</span><span class="n">ToObject</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Skill</span><span class="p">&gt;&gt;(</span><span class="n">File</span><span class="p">.</span><span class="nf">ReadAllText</span><span class="p">(</span><span class="s">"json.txt"</span><span class="p">));</span>
    <span class="c1">//解析Object</span>
    <span class="n">SkillObject</span> <span class="n">so</span> <span class="p">=</span> <span class="n">JsonMapper</span><span class="p">.</span><span class="n">ToObject</span><span class="p">&lt;</span><span class="n">SkillObject</span><span class="p">&gt;(</span><span class="n">File</span><span class="p">.</span><span class="nf">ReadAllText</span><span class="p">(</span><span class="s">"json.txt"</span><span class="p">));</span>
    
    <span class="c1">//输出list里的元素</span>
    <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">temp</span> <span class="k">in</span> <span class="n">skillArray</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">temp</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="c1">//输出object里list的元素</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">temp</span> <span class="k">in</span> <span class="n">so</span><span class="p">.</span><span class="n">SkillList</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">temp</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="用-newtonsoftjson-解析json">用 Newtonsoft.Json 解析Json</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="c1">//Visual Studio 右键项目-管理NuGet包-Newtonsoft json,添加包</span>
<span class="c1">//Unity package manager - 左上角 Add package from git URL : https://github.com/jilleJr/Newtonsoft.Json-for-Unity.git#upm </span>


</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="oldb操作数据库及excel">OLDB操作数据库及excel</h2>

<p>使用插件把excel转成json</p>

<p><a href="https://github.com/koalaylj/xlsx2json">参考</a></p>



      </section>


      <!-- <script type="text/javascript">
        $(document).ready(function() {
        $('#toc').toc();
        });
      </script> -->



      <footer>
      <p><small>BackTo <a href="https://8ku.github.io/note_other">Home</a>  |  To<a href="javascript:scroll(0,0)"> TOP</a></small></p>
      <!--  <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p> -->
      </footer>
    </div>



    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    

  </body>
</html>
