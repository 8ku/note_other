<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- <link rel="stylesheet" href="/note_other/assets/css/syntax.css"> -->
    
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Unity中的C#语法 | note_other</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Unity中的C#语法" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="书籍以外的各种笔记" />
<meta property="og:description" content="书籍以外的各种笔记" />
<link rel="canonical" href="http://localhost:4000/note_other/post/Code/C_Sharp/Unity_C_Sharp/Unity_C_Sharp.html" />
<meta property="og:url" content="http://localhost:4000/note_other/post/Code/C_Sharp/Unity_C_Sharp/Unity_C_Sharp.html" />
<meta property="og:site_name" content="note_other" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Unity中的C#语法" />
<script type="application/ld+json">
{"url":"http://localhost:4000/note_other/post/Code/C_Sharp/Unity_C_Sharp/Unity_C_Sharp.html","headline":"Unity中的C#语法","description":"书籍以外的各种笔记","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <!-- 字体自适应放大 -->
    <link rel="stylesheet" href="/note_other/assets/css/style.css?v=6e16c63238836bca6af2e9013f7f75717d6f21ee">
    <script src="/note_other/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- 显示页内目录 -->
    <!-- <script src="https://raw.githubusercontent.com/8ku/note_other/master/_js/jquery-3.5.1.min.js" type="text/javascript"></script> 
    <script src="https://raw.githubusercontent.com/8ku/note_other/master/_js/toc.js" type="text/javascript"></script> -->


	<!-- 显示数学公式 -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script> 

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>

    <div class="wrapper">
      <header>
        <h1 class="header"><a href="/note_other">note_other</a></h1>
        <p class="header">书籍以外的各种笔记</p>    
        <ul> 
          <li><a class="header name" href="https://8ku.github.io/note_other/search">Search</a></li>     	
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/Code/summary">Code</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/Unity/summary">Unity</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/math/summary">Math</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/RegularExpression/summary">RegularExpression</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/system/summary">System</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/WomensHistory/summary">WomensHistory</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/mythology/summary">Mythology</a></li>
        	<li><a class="header name" href="https://8ku.github.io/note_other/post/GameHistory/summary">GameHistory</a></li>
        	<li><a class="header name" href="/note_other/post/Biology/summary">Biology</a></li>
        	<li><a class="header name" href="/note_other/post/Draw/summary">Draw</a></li>
        </ul>

        <ul>
            <li><a class="buttons github" href="https://github.com/8ku/note_other">GitHub</a></li>
        </ul>

        <!-- <ul>
          
          <li><a class="buttons github" href="https://github.com/8ku/note_other">View On GitHub</a></li>
        </ul> --> 

        <!-- 
          <p class="header">This project is maintained by <a class="header name" href="https://github.com/8ku">8ku</a></p>
         -->

        <!--   -->
      </header>

      <div id="toc"></div>
      <section>

        <h1 id="unity中的c语法">Unity中的C#语法</h1>

<ul id="markdown-toc">
  <li><a href="#unity中的c语法" id="markdown-toc-unity中的c语法">Unity中的C#语法</a>    <ul>
      <li><a href="#基本格式" id="markdown-toc-基本格式">基本格式</a>        <ul>
          <li><a href="#命名空间和类" id="markdown-toc-命名空间和类">命名空间和类</a></li>
          <li><a href="#结构体-struct" id="markdown-toc-结构体-struct">结构体 struct</a></li>
          <li><a href="#monobahaviour" id="markdown-toc-monobahaviour">MonoBahaviour</a></li>
          <li><a href="#使用debug来显示操作情况" id="markdown-toc-使用debug来显示操作情况">使用Debug来显示操作情况</a></li>
        </ul>
      </li>
      <li><a href="#移动跳跃动画" id="markdown-toc-移动跳跃动画">移动，跳跃，动画</a>        <ul>
          <li><a href="#3d移动目标" id="markdown-toc-3d移动目标">3d移动目标</a></li>
        </ul>
      </li>
      <li><a href="#镜头跟踪" id="markdown-toc-镜头跟踪">镜头跟踪</a></li>
      <li><a href="#forwhile-循环销毁子物体" id="markdown-toc-forwhile-循环销毁子物体">for/while 循环销毁子物体</a>        <ul>
          <li><a href="#foreach-循环" id="markdown-toc-foreach-循环">foreach 循环</a></li>
        </ul>
      </li>
      <li><a href="#访问组件启用禁用组件" id="markdown-toc-访问组件启用禁用组件">访问组件，启用/禁用组件</a>        <ul>
          <li><a href="#获取本物体子物体中的组件" id="markdown-toc-获取本物体子物体中的组件">获取本物体/子物体中的组件</a></li>
          <li><a href="#获取其他物体及组件" id="markdown-toc-获取其他物体及组件">获取其他物体及组件</a></li>
          <li><a href="#启用禁用组件" id="markdown-toc-启用禁用组件">启用/禁用组件</a></li>
        </ul>
      </li>
      <li><a href="#实例化" id="markdown-toc-实例化">实例化</a></li>
      <li><a href="#singleton-实例化" id="markdown-toc-singleton-实例化">Singleton 实例化</a></li>
      <li><a href="#normalized-归一化" id="markdown-toc-normalized-归一化">normalized 归一化</a></li>
      <li><a href="#input" id="markdown-toc-input">Input</a></li>
      <li><a href="#位置及跟随运动" id="markdown-toc-位置及跟随运动">位置及跟随运动</a></li>
      <li><a href="#碰撞" id="markdown-toc-碰撞">碰撞</a></li>
      <li><a href="#触发区域" id="markdown-toc-触发区域">触发区域</a></li>
      <li><a href="#random-随机数" id="markdown-toc-random-随机数">Random 随机数</a></li>
      <li><a href="#显示分数" id="markdown-toc-显示分数">显示分数</a></li>
      <li><a href="#重载切换场景" id="markdown-toc-重载切换场景">重载/切换场景</a></li>
      <li><a href="#时间" id="markdown-toc-时间">时间</a>        <ul>
          <li><a href="#time" id="markdown-toc-time">Time</a></li>
        </ul>
      </li>
      <li><a href="#发送消息" id="markdown-toc-发送消息">发送消息</a></li>
      <li><a href="#协程-coroutine" id="markdown-toc-协程-coroutine">协程 Coroutine</a></li>
      <li><a href="#math的应用" id="markdown-toc-math的应用">Math的应用</a></li>
      <li><a href="#quaternion-四元数" id="markdown-toc-quaternion-四元数">Quaternion 四元数</a></li>
      <li><a href="#rigidbody" id="markdown-toc-rigidbody">Rigidbody</a>        <ul>
          <li><a href="#move-and-rotation" id="markdown-toc-move-and-rotation">Move and rotation</a></li>
          <li><a href="#addforce-vector3--forcemode--" id="markdown-toc-addforce-vector3--forcemode--">AddForce( Vector3 , ForceMode ) ;</a></li>
        </ul>
      </li>
      <li><a href="#camera" id="markdown-toc-camera">Camera</a>        <ul>
          <li><a href="#从物体发出射线" id="markdown-toc-从物体发出射线">从物体发出射线</a></li>
        </ul>
      </li>
      <li><a href="#监听gui-事件" id="markdown-toc-监听gui-事件">监听GUI 事件</a>        <ul>
          <li><a href="#跟鼠标相关的事件接口" id="markdown-toc-跟鼠标相关的事件接口">跟鼠标相关的事件接口</a></li>
        </ul>
      </li>
      <li><a href="#charactercontroller" id="markdown-toc-charactercontroller">CharacterController</a></li>
      <li><a href="#mesh" id="markdown-toc-mesh">Mesh</a></li>
      <li><a href="#material" id="markdown-toc-material">Material</a></li>
      <li><a href="#数组" id="markdown-toc-数组">数组</a></li>
      <li><a href="#冻结解冻游戏" id="markdown-toc-冻结解冻游戏">冻结/解冻游戏</a></li>
    </ul>
  </li>
</ul>

<h2 id="基本格式">基本格式</h2>

<ul>
  <li>方法用大驼峰；</li>
  <li>变量用小驼峰；</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngige</span><span class="p">;</span>
<span class="c1">// PlayController :脚本名</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">PlayerController</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> 
<span class="p">{</span>
  <span class="c1">//只会执行一次，一般用来初始化</span>
	<span class="k">void</span> <span class="nf">Start</span><span class="p">()</span> 
  <span class="p">{</span>
    
  <span class="p">}</span>
    <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span> 
   <span class="p">{</span>
      
   <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>
    <p>不需要带Main方法</p>
  </li>
  <li>
    <p>要访问类中的值，值必须是公开的</p>

    <div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">someting</span><span class="p">:</span><span class="n">MonoBehaviour</span>
<span class="p">{</span>
  <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="n">Enemy</span> <span class="n">enemy</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Enemy</span><span class="p">();</span> <span class="c1">//调用类时需要先实例化</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">enemy</span><span class="p">.</span><span class="n">name</span><span class="p">);</span> <span class="c1">//可访问到 name 字段，不能访问到 hp 字段</span>
    <span class="n">enemy</span><span class="p">.</span><span class="nf">Move</span><span class="p">();</span> <span class="c1">//调用方法时直接写，不需要打印，只有字段才用打印</span>
    <span class="nf">Invoke</span><span class="p">(</span><span class="s">"Move"</span><span class="p">,</span> <span class="m">2.0f</span><span class="p">);</span> <span class="c1">// 直接调用方法，在2秒之后调用</span>
    <span class="nf">InvokeRepeating</span><span class="p">(</span><span class="s">"Move"</span><span class="p">,</span><span class="m">4.0f</span><span class="p">,</span><span class="m">2.0f</span><span class="p">);</span> <span class="c1">// 4秒之后调用，每2秒调用一次</span>
  <span class="p">}</span>
    
  <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// Cancel all Invoke calls</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="nf">GetButton</span><span class="p">(</span><span class="s">"Fire1"</span><span class="p">))</span>
            <span class="nf">CancelInvoke</span><span class="p">();</span> <span class="c1">//可以在开始时调用方法，在 Update 中监听按键，取消调用所有方法 Cancels all Invoke calls</span>
    <span class="p">}</span>  
<span class="p">}</span>
  
<span class="k">class</span> <span class="nc">Enemy</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="kt">string</span> <span class="n">name</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">hp</span><span class="p">;</span> <span class="c1">//默认是私有的，不显示，也不可从外部调用</span>
  <span class="k">public</span> <span class="k">void</span> <span class="nf">Move</span><span class="p">()</span> <span class="c1">//方法如果不 public 外部无法调用</span>
  <span class="p">{</span>
    <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">name</span> <span class="p">+</span> <span class="s">"move"</span><span class="p">);</span> <span class="c1">// 方法可调用同一个类下的字段，print是 MonoBehavious 中的方法，自定义类不包含 print 方法，不能使用 print</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<h3 id="命名空间和类">命名空间和类</h3>

<p>可自定义命名空间和类，并在代码中引用</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">MyGame</span><span class="p">;</span> <span class="c1">//声明命名空间</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Player</span><span class="p">:</span><span class="n">MonoBehaviour</span>
<span class="p">{</span>
  <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="n">GameData</span> <span class="n">gd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GameData</span><span class="p">();</span> <span class="c1">//实例化自定义命名空间 MyGame 中的自定义类 GameData</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">gd</span><span class="p">.</span><span class="n">name</span><span class="p">);</span> <span class="c1">//输出实例化 GameData 中的字段</span>
    <span class="n">gd</span><span class="p">.</span><span class="nf">FunctionName</span><span class="p">();</span> <span class="c1">//输出实例化 GameData 中的方法</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">namespace</span> <span class="nn">MyGame</span> <span class="c1">//定义命名空间</span>
<span class="p">{</span>
  <span class="k">class</span> <span class="nc">GameData</span> <span class="c1">//定义类</span>
  <span class="p">{</span>
     <span class="k">public</span> <span class="k">void</span> <span class="nf">FunctionName</span><span class="p">()</span> <span class="c1">//定义方法</span>
     <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"output"</span><span class="p">);</span>
     <span class="p">}</span>
    <span class="kt">int</span> <span class="n">hp</span><span class="p">;</span>
    <span class="kt">string</span> <span class="n">name</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="结构体-struct">结构体 struct</h3>

<p>结构体和类（class）不同，结构体中的值不能单独修改，要整体赋值。例如</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">);</span>
<span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="m">10</span><span class="p">;</span> <span class="c1">//报错，不能直接修改值</span>

<span class="n">Vector3</span> <span class="n">pos</span> <span class="p">=</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">;</span> <span class="c1">//新建一个值来储存结构体信息</span>
<span class="n">pos</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="m">10</span><span class="p">;</span> <span class="c1">//修改值</span>
<span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">pos</span><span class="p">;</span> <span class="c1">//把值整体更新到结构体中</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="monobahaviour">MonoBahaviour</h3>

<p>MonoBahaviour 是所有Unity 脚本的基类。</p>

<h3 id="使用debug来显示操作情况">使用Debug来显示操作情况</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">BasicController</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="c1">// Update is called once per frame</span>
    <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Horizontal Input = "</span> <span class="p">+</span> <span class="n">Input</span><span class="p">.</span><span class="nf">GetAxis</span><span class="p">(</span><span class="s">"Horizontal"</span><span class="p">));</span> <span class="c1">//使用Debug来打印横向坐标</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>
    <p>把skybox加到camera下，可以把自定义的skybox材质放进去，在不影响编辑模式的skybox前提下显示自定义skybox</p>
  </li>
  <li>
    <p><strong>Debug 和 Print 的区别</strong>：Debug 是单独的类，Print 是 MonoBehaviour 的一个成员</p>
  </li>
  <li>
    <p>Debug的种类：</p>

    <ul>
      <li>Debug.Log：普通输出</li>
      <li>Debug.LogWarning：黄色高亮icn</li>
      <li>Debug.LogError：红色高亮icn</li>
    </ul>
  </li>
</ul>

<h2 id="移动跳跃动画">移动，跳跃，动画</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="n">RigidBody2D</span> <span class="n">rb</span><span class="p">;</span>  <span class="c1">//定义一个刚体，改名为 rb ，保存后，在图形界面上把 player 的刚体拖到这里绑定</span>
<span class="k">public</span> <span class="n">Animator</span> <span class="n">anime</span><span class="p">;</span> <span class="c1">//把动画控制器绑定角色</span>
<span class="n">publie</span> <span class="n">Collider2D</span> <span class="n">coll</span><span class="p">;</span> <span class="c1">//定义碰撞体</span>
<span class="k">public</span> <span class="kt">float</span> <span class="n">speed</span><span class="p">;</span>  <span class="c1">//定义一个类型为speed</span>
<span class="k">public</span> <span class="kt">float</span> <span class="n">jumpforce</span><span class="p">;</span> <span class="c1">//定义一个类型设置力的初始大小，在界面上</span>
<span class="k">public</span> <span class="n">LayerMask</span> <span class="n">ground</span><span class="p">;</span> <span class="c1">//定义地面</span>

<span class="c1">//FixedUpdate要求用固定的频率调用，除了用来处理物理逻辑之外并不适合处理其他模块的逻辑,有可能 fixedupdate 的频率会高于游戏设定频率，如此 fixedupdate 就会调用太多次</span>
<span class="k">void</span> <span class="nf">FixedUpdate</span><span class="p">()</span> 
<span class="p">{</span>
    <span class="nf">Movement</span><span class="p">();</span> <span class="c1">//引用movement的值</span>
<span class="p">}</span>


<span class="k">void</span> <span class="nf">Movement</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">float</span> <span class="n">horizontalmove</span> <span class="p">=</span> <span class="n">Input</span><span class="p">.</span><span class="nf">GetAxis</span><span class="p">(</span><span class="s">"Horizontal"</span><span class="p">);</span>  <span class="c1">// 读取键盘横向移动的坐标axis,横向移动只有三个值，-1 为向左移动，1 为向右移动 ，0 为不动，Horizontal要区分大小写，要拼写正确，和系统默认的名称保持一致</span>
    <span class="kt">float</span> <span class="n">facedirection</span> <span class="p">=</span> <span class="n">Input</span><span class="p">.</span><span class="nf">GetAxisRaw</span><span class="p">(</span><span class="s">"Horizontal"</span><span class="p">);</span> <span class="c1">//get axis raw 表示只取 0，1，-1 三个值</span>
  
  	<span class="c1">// 角色移动</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">horizontalmove</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span> <span class="c1">//如果横向移动的值不为0，说明 player 在移动，则设置刚体的速率为 x = 当前坐标 * 速度 ，y = 刚体的 y 速率</span>
    <span class="p">{</span>
        <span class="n">rb</span><span class="p">.</span><span class="n">velocity</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">horizontalmove</span> <span class="p">*</span> <span class="n">speed</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">delta</span><span class="p">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">rb</span><span class="p">.</span><span class="n">velocity</span><span class="p">.</span><span class="n">y</span><span class="p">);</span> <span class="c1">//delta time 表示距上一次调用Update或FixedUpdate所用的时间，使动作更平滑，而不是使用一个常量的值 </span>
      <span class="c1">// 借用 facediction 的值设置动画变换的值为1或0，为0时为 idle，为1时为 run </span>
      <span class="n">anime</span><span class="p">.</span><span class="nf">SetFloat</span><span class="p">(</span><span class="s">"running"</span><span class="p">,</span><span class="n">Mathf</span><span class="p">.</span><span class="nf">Abs</span><span class="p">(</span><span class="n">facediction</span><span class="p">));</span>
    <span class="p">}</span>
  
   <span class="k">if</span> <span class="p">(</span><span class="n">facedirection</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span>
   <span class="p">{</span>
     <span class="n">transform</span><span class="p">.</span><span class="n">localScale</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">facedirection</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">);</span> <span class="c1">// 因为 transform 的属性有 x,y,z 三个值，所以要用 vector3</span>
   <span class="p">}</span>
  
  <span class="c1">// 角色跳跃</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="nf">GetButtonDown</span><span class="p">(</span><span class="s">"Jump"</span><span class="p">))</span>
  <span class="p">{</span>
    <span class="c1">// 设置跳跃的高度，x 保持不变，y 变化</span>
    <span class="n">rb</span><span class="p">.</span><span class="n">velocity</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">rb</span><span class="p">.</span><span class="n">velocity</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">jumpforce</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">);</span>
    <span class="c1">//设置动画切换为跳跃</span>
    <span class="n">anime</span><span class="p">.</span><span class="nf">SetBool</span><span class="p">(</span><span class="s">"jumping"</span><span class="p">,</span><span class="k">true</span><span class="p">);</span> 
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">void</span> <span class="nf">SwitchAnime</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// 设定 idle 的初始状态</span>
  <span class="n">anime</span><span class="p">.</span><span class="nf">SetBool</span><span class="p">(</span><span class="s">"idle"</span><span class="p">,</span><span class="k">false</span><span class="p">);</span> 
  
  <span class="k">if</span> <span class="p">(</span><span class="n">anime</span><span class="p">.</span><span class="nf">GetBool</span><span class="p">(</span><span class="s">"jumping"</span><span class="p">))</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">rb</span><span class="p">.</span><span class="n">velocity</span><span class="p">.</span><span class="n">y</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">anime</span><span class="p">.</span><span class="nf">SetBool</span><span class="p">(</span><span class="s">"jumping"</span><span class="p">,</span><span class="k">false</span><span class="p">);</span>
      <span class="n">anime</span><span class="p">.</span><span class="nf">SetBool</span><span class="p">(</span><span class="s">"falling"</span><span class="p">,</span><span class="k">true</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">coll</span><span class="p">.</span><span class="nf">IsTouchingLayers</span><span class="p">(</span><span class="n">ground</span><span class="p">))</span>
    <span class="p">{</span>
      <span class="n">anime</span><span class="p">.</span><span class="nf">SetBool</span><span class="p">(</span><span class="s">"falling"</span><span class="p">,</span><span class="k">false</span><span class="p">);</span>
      <span class="n">anime</span><span class="p">.</span><span class="nf">SetBool</span><span class="p">(</span><span class="s">"idle"</span><span class="p">,</span><span class="k">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="3d移动目标">3d移动目标</h3>

<p>Vector3.Distance(目标位置,起始位置)</p>

<h2 id="镜头跟踪">镜头跟踪</h2>

<ol>
  <li>2D</li>
</ol>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="n">Transform</span> <span class="n">player</span><span class="p">;</span> <span class="c1">// 取得跟随对象的位置</span>

<span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">player</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">player</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="p">-</span><span class="m">10f</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li>3D</li>
</ol>

<p>脚本挂在相机上</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="n">Transform</span> <span class="n">player</span><span class="p">;</span> <span class="c1">// 取得跟随对象的位置</span>
<span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span> <span class="c1">//显示私有变量，能在Inspector中编辑</span>
<span class="k">private</span> <span class="n">Vector3</span> <span class="n">offset</span><span class="p">;</span> <span class="c1">// 设置初始距离</span>

<span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">offset</span> <span class="p">=</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">-</span> <span class="n">player</span><span class="p">.</span><span class="n">position</span><span class="p">;</span> <span class="c1">//初始化时得到相机和跟随对象的距离</span>
<span class="p">}</span>
<span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">hero</span><span class="p">.</span><span class="n">position</span><span class="p">;</span> <span class="c1">// 移动时相机的位置 = 跟随对象的位置 + 两者的距离</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="forwhile-循环销毁子物体">for/while 循环销毁子物体</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
	<span class="c1">// Transform 是 Unity 的一种内置类型，获得这个主体下的所有子级</span>
  <span class="n">Transform</span><span class="p">[]</span> <span class="n">children</span> <span class="p">=</span> <span class="n">transform</span><span class="p">.</span><span class="n">GetComponentsInChildren</span><span class="p">&lt;</span><span class="n">Transform</span><span class="p">&gt;();</span>

  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span><span class="p">&lt;</span> <span class="n">children</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> <span class="c1">// 遍历子级的长度</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">!=</span> <span class="n">transform</span><span class="p">)</span> <span class="c1">//如果子级中不包含本体，如果不写这一句，会把父级一起销毁</span>
        <span class="p">{</span>
          <span class="n">GameObject</span><span class="p">.</span><span class="nf">Destroy</span><span class="p">(</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">gameObject</span><span class="p">);</span> <span class="c1">//销毁子级</span>
          <span class="k">break</span><span class="p">;</span><span class="c1">//可以用 break 来打断或中断循环</span>
        <span class="p">}</span>
      <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>while 语句：</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Transform</span><span class="p">[]</span> <span class="n">children</span> <span class="p">=</span> <span class="n">transform</span><span class="p">.</span><span class="n">GetComponentsInChildren</span><span class="p">&lt;</span><span class="n">Transform</span><span class="p">&gt;();</span>
  
  <span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
  <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="p">&lt;</span> <span class="n">children</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">!=</span> <span class="n">transform</span><span class="p">)</span> 
        <span class="p">{</span>
          <span class="n">GameObject</span><span class="p">.</span><span class="nf">Destroy</span><span class="p">(</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">gameObject</span><span class="p">);</span> <span class="c1">//销毁子级</span>
        <span class="p">}</span>
    		<span class="n">i</span><span class="p">++;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="foreach-循环">foreach 循环</h3>

<p>也称为只读循环，相比 for 循环更简洁，只能遍历，不能修改值。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">HeroType</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Transform</span><span class="p">[]</span> <span class="n">children</span> <span class="p">=</span> <span class="n">transform</span><span class="p">.</span><span class="n">GetComponentsInChildren</span><span class="p">&lt;</span><span class="n">Transform</span><span class="p">&gt;();</span>

        <span class="k">foreach</span><span class="p">(</span><span class="n">Transform</span> <span class="n">i</span> <span class="k">in</span> <span class="n">children</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">!=</span> <span class="n">transform</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="nf">Destroy</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">gameObject</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="访问组件启用禁用组件">访问组件，启用/禁用组件</h2>

<h3 id="获取本物体子物体中的组件">获取本物体/子物体中的组件</h3>

<p>通过 transform 组件获取物体，因为所有物体都有 transform 组件，所以可以用 transform 代表物体本身</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">Transform</span> <span class="n">t</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Transform</span><span class="p">&gt;();</span> <span class="c1">//Transform:组件类型,transform 是内置组件，可以不用用 get 来访问</span>

<span class="n">Transform</span> <span class="n">t</span> <span class="p">=</span> <span class="n">GetComponentInChildren</span><span class="p">&lt;</span><span class="n">Transform</span><span class="p">&gt;();</span> <span class="c1">//获取子物件组件</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>获取子物体</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">transform</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">"子级/孙级"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="获取其他物体及组件">获取其他物体及组件</h3>

<ol>
  <li>获取物体 game object</li>
</ol>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="n">GameObject</span> <span class="n">someone</span><span class="p">;</span>  <span class="c1">//先定义一个参数，把要获取的物体拖拽进来</span>

<span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">someone</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody2D</span><span class="p">&gt;();</span> <span class="c1">//获取物体组件</span>
  <span class="n">someone</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">ClssFileName</span><span class="p">&gt;().</span><span class="n">method</span><span class="p">;</span> <span class="c1">//获取物体脚本中的方法</span>
  <span class="n">someone</span><span class="p">.</span><span class="n">GetComponentInParent</span><span class="p">&lt;</span><span class="n">ClssFileName</span><span class="p">&gt;.</span><span class="n">method</span><span class="p">;</span> <span class="c1">//视角：子物体身上的脚本，获得父物体身上的脚本方法</span>
  <span class="n">someone</span><span class="p">.</span><span class="n">GetComponentInChildren</span><span class="p">&lt;</span><span class="n">ClassFileName</span><span class="p">&gt;.</span><span class="n">method</span><span class="p">;</span> <span class="c1">//父物体获得子物体身上的脚本方法</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li>
    <p>获取组件及脚本</p>

    <p>查询 Unity 核心模块：文档 <code class="language-plaintext highlighter-rouge">UnityEngine.CoreModule</code></p>
  </li>
</ol>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">somethin</span><span class="p">;</span> <span class="c1">//找脚本就直接定义脚本，找组件就定义组件，组件必须存在 </span>
<span class="k">private</span> <span class="n">Transform</span> <span class="n">something</span><span class="p">;</span> <span class="c1">//transform 是 Unity 的核心模块，可以直接定义</span>

<span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">something</span><span class="p">.</span><span class="err">子类</span><span class="p">();</span> <span class="c1">//获取脚本中的东西</span>
  <span class="n">something</span> <span class="p">=</span> <span class="n">GameObject</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">"gameObject_name"</span><span class="p">).</span><span class="n">transform</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li>通过 gameObject 的 Find 方法查找物体，如果有多个同名物品，只会返回第一个，效率很低，不推荐使用</li>
</ol>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">GameObject</span> <span class="n">go</span> <span class="p">=</span> <span class="n">GameObject</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">"Main Camera"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li>通过标签查找物体</li>
</ol>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">GameObject</span> <span class="n">go</span> <span class="p">=</span> <span class="n">GameObject</span><span class="p">.</span><span class="nf">FindWithTag</span><span class="p">(</span><span class="s">"Player"</span><span class="p">);</span> <span class="c1">//根据 tag 名称返回active 的第一个结果</span>
<span class="n">GameObject</span> <span class="n">go</span> <span class="p">=</span> <span class="n">GameObject</span><span class="p">.</span><span class="nf">FindGameObjectsWithTag</span><span class="p">(</span><span class="s">"Player"</span><span class="p">);</span> <span class="c1">//返回这个 Tag 的列表，顺序随机</span>
<span class="n">FindObjectOfType</span><span class="p">&lt;</span><span class="n">PlayerController</span><span class="p">&gt;().</span><span class="nf">CherryCount</span><span class="p">();</span> <span class="c1">//根据 object 的名称查找</span>
<span class="k">foreach</span><span class="p">(</span><span class="n">GameObject</span> <span class="n">i</span> <span class="k">in</span> <span class="n">go</span><span class="p">){</span><span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">);}</span> <span class="c1">//可以用 foreach 来查看找到的项</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li>通过单例化调用脚本，不太喜欢，static 感觉有限制，后期学ECS</li>
</ol>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">something</span><span class="p">:</span> <span class="n">MonoBehavious</span>
<span class="p">{</span>
  <span class="c1">//把该脚本单例化，就可以从别的角色直接调用该脚本下的方法和值,单例化必须保证一个类只有一个实例,并提供一个全局访问点</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">something</span> <span class="n">instance</span><span class="p">;</span> 
  
  <span class="k">private</span> <span class="k">void</span> <span class="nf">Awake</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">instance</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span><span class="c1">// 在启动时调用一下，不写会调用不了。</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>单例模式的注意点</strong></p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="c1">//定义一个静态变量来保存类的实例,此例的类名为 Singleton</span>
<span class="k">private</span> <span class="k">static</span> <span class="n">Singleton</span> <span class="n">instance</span><span class="p">;</span>

<span class="c1">//定义私有构造函数,外界不能创建该类实例</span>
<span class="k">private</span> <span class="nf">Singleton</span><span class="p">(){}</span>

<span class="c1">//定义一个标识来标记线程开关</span>
<span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">object</span> <span class="n">locker</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">object</span><span class="p">();</span>

<span class="c1">//定义仅有方法提供一个全局访问点,也可以定义公有属性提供全局访问点</span>
<span class="k">public</span> <span class="k">static</span> <span class="n">Singleton</span> <span class="nf">GetInstance</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">//使用 lock 方法</span>
  <span class="c1">//lock 语句获取给定对象的互斥 lock，执行语句块，然后释放 lock。 持有 lock 时，持有 lock 的线程可以再次获取并释放 lock。 阻止任何其他线程获取 lock 并等待释放 lock。</span>
  <span class="c1">// 当第一个线程运行到这里时，此时会对locker对象 "加锁"，</span>
  <span class="c1">// 当第二个线程运行该方法时，首先检测到locker对象为"加锁"状态，该线程就会挂起等待第一个线程解锁</span>
  <span class="c1">// lock语句运行完之后（即线程运行完之后）会对该对象"解锁"</span>
  <span class="k">lock</span> <span class="p">(</span><span class="n">locker</span><span class="p">)</span>
  <span class="p">{</span>
  	<span class="k">if</span> <span class="p">(</span><span class="n">instance</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
  	<span class="p">{</span>    
      <span class="c1">//如果类的实例不存在则创建,否则直接返回</span>
    	<span class="n">instance</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Singleton</span><span class="p">();</span>
    <span class="p">}</span>    
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">instance</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1">//调用的脚本</span>
<span class="n">something</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="nf">function</span><span class="p">();</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="启用禁用组件">启用/禁用组件</h3>

<p>只有视图面板上可以勾选的组件可以被启/禁用</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">BoxCollider2D</span> <span class="n">coll</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">BoxCollider2D</span><span class="p">&gt;();</span> <span class="c1">//获取物体组件</span>
  <span class="n">coll</span><span class="p">.</span><span class="n">enabled</span> <span class="p">=</span>  <span class="k">false</span><span class="p">;</span> <span class="c1">//禁用组件</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="实例化">实例化</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="n">GameObject</span> <span class="n">bullet</span><span class="p">;</span> <span class="c1">//建一个游戏物体，把要实例化的物体拖拽进来</span>

<span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
  <span class="nf">newBullet</span><span class="p">();</span> <span class="c1">//调用实例</span>
<span class="p">}</span>


<span class="k">void</span> <span class="nf">newBullet</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">bu</span> <span class="p">=</span> <span class="n">GameObject</span><span class="p">.</span><span class="nf">Instantiate</span><span class="p">(</span> <span class="n">bullet</span><span class="p">,</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="n">transform</span><span class="p">.</span><span class="n">rotation</span><span class="p">);</span> <span class="c1">// instantiate:实例化，第一个值：实例化的原对象，第二：位置，第三：角度</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="singleton-实例化">Singleton 实例化</h2>

<p>从游戏开始到关闭都会一直存在, 不会被销毁, 一般用于Game Setting, 管理场景 关卡 音乐切换</p>

<p>singleton会隐藏脚本依赖, 如果脚本里的方法有依赖, 会使问题变得不易发现.</p>

<h2 id="normalized-归一化">normalized 归一化</h2>

<p>把当前值转化为（0，1）内的值。为了简化运算，优化性能。</p>

<p>Current vector is unchanged .</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">Vector2</span> <span class="n">direction</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">).</span><span class="n">normalized</span><span class="p">;</span>
<span class="nf">Move</span><span class="p">(</span><span class="n">direction</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="input">Input</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">Input</span><span class="p">.</span><span class="nf">GetMouseButtonDown</span><span class="p">(</span><span class="m">0</span><span class="p">);</span> <span class="c1">//0:鼠标左键，1：鼠标右键，2：鼠标中键</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1">// 用按键给物体的运动加速</span>
<span class="n">cube</span><span class="p">.</span><span class="nf">Translate</span><span class="p">(</span><span class="n">Vector3</span><span class="p">.</span><span class="n">right</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span> <span class="p">*</span> <span class="n">Input</span><span class="p">.</span><span class="nf">GetAxis</span><span class="p">(</span><span class="s">"Horizontal"</span><span class="p">));</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="位置及跟随运动">位置及跟随运动</h2>

<ul>
  <li>
    <p>设置一个物体和另一个物体有一段距离时停止运动</p>
  </li>
  <li>
    <p>Vector的方向：</p>

    <ul>
      <li>假设 a &gt; b （a(3,4,5),b(2,2,1)）</li>
      <li>a - b ：b 向 a 运动</li>
      <li>b - a：a 向 b 运动</li>
    </ul>

    <div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="n">Transform</span> <span class="n">b</span><span class="p">;</span>
  
<span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">b</span> <span class="p">=</span> <span class="n">GameObject</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">"target"</span><span class="p">).</span><span class="n">transform</span><span class="p">;</span>
<span class="p">}</span>
  
<span class="n">a</span> <span class="p">=</span> <span class="n">b</span><span class="p">.</span><span class="n">position</span><span class="p">;</span> <span class="c1">// 先取得 b 的位置</span>
<span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="p">-=</span> <span class="m">1.5f</span><span class="p">;</span> <span class="c1">// a 的 y (或 x ) - a和 b 的距离</span>
  
<span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="nf">MoveTowards</span><span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">speed</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">);</span> <span class="c1">//使用 MoveTowards 方法</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>跟随运动</p>

    <div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">transform</span><span class="p">.</span><span class="n">parent</span> <span class="p">=</span> <span class="n">b</span><span class="p">;</span> <span class="c1">//指定物体为父级</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<h2 id="碰撞">碰撞</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="k">void</span> <span class="nf">OnCollisionEnter</span><span class="p">(</span><span class="n">Collider2D</span> <span class="n">collision</span><span class="p">)</span>
<span class="p">{</span>
  <span class="nf">print</span><span class="p">(</span><span class="n">collision</span><span class="p">.</span><span class="n">collider</span><span class="p">.</span><span class="n">name</span><span class="p">);</span> <span class="c1">//获取碰撞物体的名字</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="触发区域">触发区域</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="k">void</span> <span class="nf">OnTriggerEnter</span><span class="p">(</span><span class="n">Collider</span> <span class="n">other</span><span class="p">)</span> <span class="c1">//此方法不需要更改方法，只编辑返回值就可以</span>
    <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"opps! "</span> <span class="p">+</span> <span class="n">other</span><span class="p">.</span><span class="n">name</span><span class="p">);</span> <span class="c1">//获取碰到的触发物体的名字</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="random-随机数">Random 随机数</h2>

<ul>
  <li>` Random.Range(min,max);  `
    <ul>
      <li>int : Return a random integer number between <code class="language-plaintext highlighter-rouge">min</code> [inclusive] and <code class="language-plaintext highlighter-rouge">max</code> [exclusive]</li>
      <li>float：Return a random float number between  ` min `  [inclusive] and ` max ` [inclusive]</li>
    </ul>
  </li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">ExampleClass</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">GameObject</span> <span class="n">prefab</span><span class="p">;</span>
    <span class="c1">// Instantiate the Prefab somewhere between -10.0 and 10.0 on the x-z plane</span>
    <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Vector3</span> <span class="n">position</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">Random</span><span class="p">.</span><span class="nf">Range</span><span class="p">(-</span><span class="m">10.0f</span><span class="p">,</span> <span class="m">10.0f</span><span class="p">),</span> <span class="m">0</span><span class="p">,</span> <span class="n">Random</span><span class="p">.</span><span class="nf">Range</span><span class="p">(-</span><span class="m">10.0f</span><span class="p">,</span> <span class="m">10.0f</span><span class="p">));</span>
        <span class="nf">Instantiate</span><span class="p">(</span><span class="n">prefab</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">);</span> <span class="c1">//Quaternion.identity:不旋转</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>` Random.InitState(int seed);  `</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="kt">float</span><span class="p">[]</span> <span class="n">noiseValues</span><span class="p">;</span>
    <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Random</span><span class="p">.</span><span class="nf">InitState</span><span class="p">(</span><span class="m">10</span><span class="p">);</span> <span class="c1">//10 seed, if don't set ,Unity will random as it own rule.</span>
      	<span class="c1">// Random.InitState((int)System.DateTime.Now.Ticks); // get the system time and force change frome long to int, not necessary</span>
        <span class="n">noiseValues</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">float</span><span class="p">[</span><span class="m">5</span><span class="p">];</span> <span class="c1">//5 line</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">noiseValues</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">noiseValues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="k">value</span><span class="p">;</span> <span class="c1">//Random.value is return a random number between 0.0[inclusive] and 1.0[inclusive]</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">noiseValues</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>
    <p>` Random.insideUnitCircle ` 在一个半径为1的圆的范围内随机生成</p>

    <div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="n">insideUnitCircle</span> <span class="p">*</span> <span class="m">5</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>` Random.insideUnitSphere ` 在一个半径为1的球体内随机生成</p>
  </li>
</ul>

<h2 id="显示分数">显示分数</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">UnityEngine.UI</span><span class="p">;</span> <span class="c1">// 要用 text 组件显示分数 ，text 在 UI Module 下</span>

<span class="k">public</span> <span class="n">Text</span> <span class="n">scoreText</span><span class="p">;</span> <span class="c1">// 定义一个变量放 text 组件</span>
<span class="k">private</span> <span class="kt">int</span> <span class="n">scores</span><span class="p">;</span> <span class="c1">// 定义一个变量接收分数计数</span>
<span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="nf">GetMouseButtonDown</span><span class="p">(</span><span class="m">0</span><span class="p">))</span> <span class="c1">// 每按一次鼠标</span>
   <span class="p">{</span>
     <span class="n">scores</span><span class="p">++;</span> <span class="c1">// 分数+1</span>
     <span class="n">scoreText</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="n">scores</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span> <span class="c1">//把 scores 中存的值显示在 scoreText 上。</span>
   <span class="p">}</span>
  
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="重载切换场景">重载/切换场景</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">UnityEngine.SceneManagement</span><span class="p">;</span> <span class="c1">//需要调用场景管理 Module</span>

<span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">SceneManager</span><span class="p">.</span><span class="nf">LoadScene</span><span class="p">(</span><span class="n">SceneManager</span><span class="p">.</span><span class="nf">GetActiveScene</span><span class="p">().</span><span class="n">buildIndex</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>显示场景加载进度 ` SceneManager.LoadSceneAsync `</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">UnityEngine.SceneManagement</span><span class="p">;</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">Example</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// Press the space key to start coroutine</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="nf">GetKeyDown</span><span class="p">(</span><span class="n">KeyCode</span><span class="p">.</span><span class="n">Space</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="c1">// Use a coroutine to load the Scene in the background</span>
            <span class="nf">StartCoroutine</span><span class="p">(</span><span class="nf">LoadYourAsyncScene</span><span class="p">());</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">IEnumerator</span> <span class="nf">LoadYourAsyncScene</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// The Application loads the Scene in the background as the current Scene runs.</span>
        <span class="c1">// This is particularly good for creating loading screens.</span>
        <span class="c1">// You could also load the Scene by using sceneBuildIndex. In this case Scene2 has</span>
        <span class="c1">// a sceneBuildIndex of 1 as shown in Build Settings.</span>

        <span class="n">AsyncOperation</span> <span class="n">asyncLoad</span> <span class="p">=</span> <span class="n">SceneManager</span><span class="p">.</span><span class="nf">LoadSceneAsync</span><span class="p">(</span><span class="s">"Scene2"</span><span class="p">);</span>

        <span class="c1">// Wait until the asynchronous scene fully loads</span>
        <span class="k">while</span> <span class="p">(!</span><span class="n">asyncLoad</span><span class="p">.</span><span class="n">isDone</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">yield</span> <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="时间">时间</h2>

<h3 id="time">Time</h3>

<ul>
  <li>
    <p>` Time.timeScale` 控制动作的快慢，0为暂停，1为匀速，&gt;1为加速 , &lt;1 为减速，不可&lt;0</p>
  </li>
  <li>
    <p>默认单位为1米，一帧调用一次 Update，则1帧运动1米，一秒60帧则1秒运动60米，使用 ` *Time.deltaTime` 是 * 每帧使用的秒数，根据电脑性能，如果 FPS 为60 ，则 Time.deltaTime 为 0.0167</p>
  </li>
  <li>
    <p>` Time.realtimeSinceStartup` ：用于测试性能耗费时间。</p>

    <div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kt">float</span> <span class="n">time1</span> <span class="p">=</span> <span class="n">Time</span><span class="p">.</span><span class="n">realtimeSinceStartup</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span><span class="p">&lt;</span> <span class="m">10</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
<span class="p">{</span>
  <span class="nf">Method1</span><span class="p">();</span>
<span class="p">}</span>
<span class="kt">float</span> <span class="n">time2</span> <span class="p">=</span> <span class="n">Time</span><span class="p">.</span><span class="n">realtimeSinceStartup</span><span class="p">;</span>
<span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">time2</span> <span class="p">-</span> <span class="n">time1</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<h2 id="发送消息">发送消息</h2>

<ol>
  <li>` GameObject.BroadcastMessage` ：给一个对象及其所有子对象发送消息（脚本挂在父物体上）</li>
</ol>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c1">// 发消息的对象</span>
<span class="k">public</span> <span class="n">GameObject</span> <span class="n">Receiver</span><span class="p">;</span> <span class="c1">//需要先指定一个接收者</span>

<span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Receiver</span><span class="p">.</span><span class="nf">BroadcastMessage</span><span class="p">(</span><span class="s">"ApplyDamage"</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c1">// 接收消息的对象</span>

<span class="k">void</span> <span class="nf">ApplyDamage</span><span class="p">()</span> <span class="c1">// 直接引用方法</span>
<span class="p">{</span>
  <span class="nf">print</span><span class="p">(</span><span class="s">"received!"</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li><code class="language-plaintext highlighter-rouge">GameObject.SendMessage</code> ：只给当前接收者发送消息，不会同时给子物体发送。</li>
</ol>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1">//发送消息方，通过 sendmessage 来触发方法</span>
<span class="n">collision</span><span class="p">.</span><span class="nf">SendMessage</span><span class="p">(</span><span class="s">"Die"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c1">//接收消息方,有一个方法就可以</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">Die</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">sr</span><span class="p">.</span><span class="n">sprite</span> <span class="p">=</span> <span class="n">BrokenSprite</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li>` GameObject.SendMessageUpwards` ：给当前物体及其父物体发送信息，直到根级</li>
</ol>

<h2 id="协程-coroutine">协程 Coroutine</h2>

<ul>
  <li>在执行其他方法时同时执行其他方法的方法。</li>
  <li>协程方法可以暂停。</li>
  <li><strong>[必须]</strong>使用 ` yield return ` 来停止并返回参数。</li>
  <li>IEnumerator：迭代器</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">time</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">GameObject</span> <span class="n">cube</span><span class="p">;</span> <span class="c1">//指定一个游戏物体</span>
  
    <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span> <span class="c1">//在 Update 方法中调用</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="nf">GetKeyDown</span><span class="p">(</span><span class="n">KeyCode</span><span class="p">.</span><span class="n">Space</span><span class="p">))</span> <span class="c1">//当按下空格键时，开启协程</span>
        <span class="p">{</span>
            <span class="nf">StartCoroutine</span><span class="p">(</span><span class="s">"Fade"</span><span class="p">);</span> <span class="c1">// 调用方法,使用方法名，开启和关闭必须使用同样的规则，例如都用方法名</span>
        <span class="p">}</span>
      	<span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="nf">GetKeyDown</span><span class="p">(</span><span class="n">KeyCode</span><span class="p">.</span><span class="n">D</span><span class="p">))</span>
        <span class="p">{</span>
          <span class="nf">StopCoroutine</span><span class="p">(</span><span class="s">"Fade"</span><span class="p">);</span> <span class="c1">//按下 D 停止调用协程，使用方法名，停止协程不能直接使用方法</span>
        <span class="p">}</span>
      
    <span class="p">}</span>
    <span class="n">IEnumerator</span> <span class="nf">Fade</span><span class="p">()</span>  <span class="c1">//定义方法</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(;</span> <span class="p">;</span> <span class="p">)</span> <span class="c1">//死循环</span>
        <span class="p">{</span>
            <span class="n">Color</span> <span class="n">c</span> <span class="p">=</span> <span class="n">cube</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Renderer</span><span class="p">&gt;().</span><span class="n">material</span><span class="p">.</span><span class="n">color</span><span class="p">;</span>
            <span class="n">Color</span> <span class="n">newColor</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="nf">Lerp</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Color</span><span class="p">.</span><span class="n">red</span><span class="p">,</span> <span class="m">0.02f</span><span class="p">);</span> <span class="c1">//使用插值 lerp</span>
            <span class="n">cube</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Renderer</span><span class="p">&gt;().</span><span class="n">material</span><span class="p">.</span><span class="n">color</span> <span class="p">=</span> <span class="n">newColor</span><span class="p">;</span>
            <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="nf">WaitForSeconds</span><span class="p">(</span><span class="m">0.1f</span><span class="p">);</span> <span class="c1">//暂停0.1秒后执行下一句</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">Mathf</span><span class="p">.</span><span class="nf">Abs</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="n">red</span><span class="p">.</span><span class="n">g</span> <span class="p">-</span> <span class="n">newColor</span><span class="p">.</span><span class="n">g</span><span class="p">)</span> <span class="p">&lt;=</span> <span class="m">0.01f</span><span class="p">)</span> <span class="c1">//如果颜色已经变为目标颜色红色</span>
            <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span> <span class="c1">//则退出循环</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="math的应用">Math的应用</h2>

<ul>
  <li>
    <p>Clamp：范围值，如果当前值大于范围最小值，取最小，当前值大于范围最大值，取最大。</p>

    <div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="kt">int</span> <span class="n">hp</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>
<span class="k">void</span> <span class="nf">TakeDamage</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">hp</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Clamp</span><span class="p">(</span><span class="n">hp</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">100</span><span class="p">);</span> <span class="c1">//当 hp 小于0，返回0；hp 大于100，返回100</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Ceil：向上取整</li>
  <li>Floor：向下取整</li>
  <li>Pow（f, p）：取 f 的 p 次方</li>
  <li>Sqrt ：返回 x 的平方根</li>
  <li>PingPong/Repeat（t , length）：值 t 在 0 ~ length 范围内循环，如果需要从 x ~ length 之间运动，` x + Mathf.PingPong(t, length-x);</li>
  <li>Lerp（a, b , t ）：a 开始值，b 结束值（b&gt;a），t 插值（t = 0，返回 a；t=1，返回b） 先快后慢。</li>
  <li>MoveTowards（current，target，maxdelta）：匀速接近或远离目标，maxdelta 步值</li>
</ul>

<h2 id="quaternion-四元数">Quaternion 四元数</h2>

<p>用于改变旋转的角度。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="n">Transform</span> <span class="n">cube</span><span class="p">;</span>
<span class="c1">// 设置物体的角度方法1:直接使用欧拉角</span>
<span class="n">cube</span><span class="p">.</span><span class="n">eulerAngles</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">45</span><span class="p">,</span> <span class="m">45</span><span class="p">,</span> <span class="m">45</span><span class="p">);</span>
<span class="c1">// 设置物体的角度方法2：把欧拉角转为四元数</span>
<span class="n">cube</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="nf">Euler</span><span class="p">(</span><span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">45</span><span class="p">,</span> <span class="m">45</span><span class="p">,</span> <span class="m">45</span><span class="p">));</span> 
<span class="n">cube</span><span class="p">.</span><span class="n">rotaiton</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="nf">Euler</span><span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">eulerAngles</span><span class="p">+</span><span class="n">bullectEulerAngles</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>LookRotation：让控制角色面向目标</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="n">Transform</span> <span class="n">Player</span><span class="p">;</span>
<span class="k">public</span> <span class="n">Transform</span> <span class="n">Enemy</span><span class="p">;</span>

<span class="k">void</span>  <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Vector3</span> <span class="n">direction</span> <span class="p">=</span> <span class="n">Enemy</span><span class="p">.</span><span class="n">position</span> <span class="p">-</span> <span class="n">Player</span><span class="p">.</span><span class="n">position</span><span class="p">;</span> <span class="c1">//从 Player 朝向 Enemy 的向量</span>
  <span class="n">direction</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="c1">//如果需要锁定某个轴的旋转</span>
  <span class="n">Player</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="nf">LookRotation</span><span class="p">(</span><span class="n">dircetion</span><span class="p">);</span>
  
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Slerp：球面插值，在插值中加入曲率，更平缓</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Vector3</span> <span class="n">direction</span> <span class="p">=</span> <span class="n">Player</span><span class="p">.</span><span class="n">position</span> <span class="p">-</span> <span class="n">Enemy</span><span class="p">.</span><span class="n">position</span><span class="p">;</span> <span class="c1">//注意方向</span>
        <span class="n">Quaternion</span> <span class="n">target</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="nf">LookRotation</span><span class="p">(</span><span class="n">direction</span><span class="p">);</span>
        <span class="n">Player</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="nf">Slerp</span><span class="p">(</span><span class="n">Player</span><span class="p">.</span><span class="n">rotation</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">);</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="rigidbody">Rigidbody</h2>

<h3 id="move-and-rotation">Move and rotation</h3>

<ul>
  <li>用 rigidbody 控制物体的移动和旋转要比 Transform 更快，如果物体有刚体时</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="n">Rigidbody</span> <span class="n">Player</span><span class="p">;</span> <span class="c1">//定义 rigidbody</span>
<span class="n">Rigidbody</span> <span class="n">Player</span><span class="p">;</span> <span class="c1">//也可以不 public rigidbody</span>
<span class="n">Vector3</span> <span class="n">v3</span><span class="p">;</span>

<span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Player</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">);</span> <span class="c1">//直接设置 rigidbody 的位置</span>
  <span class="n">v3</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">0</span><span class="p">);</span>
  <span class="n">Player</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody</span><span class="p">&gt;();</span> <span class="c1">//如果不public 获取，则需要在内部指定</span>
  
<span class="p">}</span>

<span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">player</span><span class="p">.</span><span class="nf">MovePosition</span><span class="p">(</span><span class="n">player</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">+</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">forward</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">);</span> <span class="c1">// 持续移动物体推荐使用 MovePosition ，MovePosition 会给移动增加插值，使移动更平滑，如果需要直接移动，使用 position </span>
  <span class="n">Quaternion</span> <span class="n">deltaRotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="nf">Euler</span><span class="p">(</span><span class="n">v3</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">);</span> <span class="c1">// Rigidbody 的 rotation 是一个 Quaternion</span>
  <span class="n">player</span><span class="p">.</span><span class="nf">MoveRotation</span><span class="p">(</span><span class="n">player</span><span class="p">.</span><span class="n">rotation</span> <span class="p">*</span> <span class="n">deltaRotation</span><span class="p">);</span><span class="c1">//持续旋转物体使用 MoveRotation,此处为 让物体围绕世界坐标的 y 轴旋转</span>
  
  
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="addforce-vector3--forcemode--">AddForce( Vector3 , ForceMode ) ;</h3>

<p>给运动添加力，力符合力学定律。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="kt">int</span><span class="p">/</span><span class="kt">float</span> <span class="n">force</span><span class="p">;</span>
<span class="k">public</span> <span class="n">Rigidbody</span> <span class="n">Player</span><span class="p">;</span>

<span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Player</span><span class="p">.</span><span class="nf">AddForce</span><span class="p">(</span><span class="nf">Vector3</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">20</span><span class="p">,</span><span class="m">0</span><span class="p">)</span> <span class="p">*</span> <span class="n">force</span><span class="p">,</span><span class="n">ForceMode</span><span class="p">.</span><span class="n">Force</span><span class="p">);</span> <span class="c1">//或者把 force 使用在某个轴上</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th><a href="ForceMode.Force.html">Force</a></th>
      <th>Add a continuous force to the rigidbody, using its mass.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="ForceMode.Acceleration.html">Acceleration</a></td>
      <td>Add a continuous acceleration to the rigidbody, ignoring its mass.</td>
    </tr>
    <tr>
      <td><a href="ForceMode.Impulse.html">Impulse</a></td>
      <td>Add an instant force impulse to the rigidbody, using its mass.</td>
    </tr>
    <tr>
      <td><a href="ForceMode.VelocityChange.html">VelocityChange</a></td>
      <td>Add an instant velocity change to the rigidbody, ignoring its mass.</td>
    </tr>
  </tbody>
</table>

<h2 id="camera">Camera</h2>

<ul>
  <li>获得鼠标点击的位置，并返回物体的名字</li>
</ul>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>    <span class="k">private</span> <span class="n">Camera</span> <span class="n">mainCamera</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>       
        <span class="n">mainCamera</span> <span class="p">=</span> <span class="n">Camera</span><span class="p">.</span><span class="n">main</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Ray</span> <span class="n">ray</span> <span class="p">=</span> <span class="n">mainCamera</span><span class="p">.</span><span class="nf">ScreenPointToRay</span><span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="n">mousePosition</span><span class="p">);</span> <span class="c1">//创建射线</span>
      	<span class="n">Ray</span> <span class="n">ray</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Ray</span><span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="n">transform</span><span class="p">.</span><span class="n">forward</span><span class="p">);</span> <span class="c1">//创建射线的另一个方法    </span>
        <span class="n">RaycastHit</span> <span class="n">hit</span><span class="p">;</span> <span class="c1">//定义一个变量放 out 的参数</span>
        <span class="kt">bool</span> <span class="n">isCollider</span> <span class="p">=</span> <span class="n">Physics</span><span class="p">.</span><span class="nf">Raycast</span><span class="p">(</span><span class="n">ray</span><span class="p">,</span> <span class="k">out</span> <span class="n">hit</span><span class="p">);</span> <span class="c1">//raycast 可以指定射线长度</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">isCollider</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">hit</span><span class="p">.</span><span class="n">collider</span><span class="p">.</span><span class="n">name</span><span class="p">);</span> <span class="c1">//返回鼠标触碰的物体的名字</span>
          	<span class="n">Debug</span><span class="p">.</span><span class="nf">DrawRay</span><span class="p">(</span><span class="n">ray</span><span class="p">.</span><span class="n">origin</span><span class="p">,</span> <span class="n">ray</span><span class="p">.</span><span class="n">direction</span> <span class="p">*</span> <span class="m">10</span><span class="p">,</span> <span class="n">Color</span><span class="p">.</span><span class="n">yellow</span><span class="p">);</span> <span class="c1">//画出射线</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="从物体发出射线">从物体发出射线</h3>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="c1">//从IK脚部发出射线</span>
<span class="n">RaycastHit</span> <span class="n">hit</span><span class="p">;</span>
<span class="n">Ray</span> <span class="n">ray</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Ray</span><span class="p">(</span><span class="n">animator</span><span class="p">.</span><span class="nf">GetIKPosition</span><span class="p">(</span><span class="n">AvatarIKGoal</span><span class="p">.</span><span class="n">LeftFoot</span><span class="p">)</span> <span class="p">+</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">up</span><span class="p">,</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">down</span><span class="p">);</span>
<span class="n">Debug</span><span class="p">.</span><span class="nf">DrawyRay</span><span class="p">(</span><span class="n">animator</span><span class="p">.</span><span class="nf">GetIKPosition</span><span class="p">(</span><span class="n">AvatarIKGoal</span><span class="p">.</span><span class="n">LeftFoot</span><span class="p">),</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">down</span><span class="p">,</span> <span class="n">Color</span><span class="p">.</span><span class="n">red</span><span class="p">);</span>

<span class="c1">//从碰撞物体表面发出normal射线</span>
<span class="n">Debug</span><span class="p">.</span><span class="nf">DrawRay</span><span class="p">(</span><span class="n">hit</span><span class="p">.</span><span class="n">nomal</span><span class="p">,</span> <span class="n">hit</span><span class="p">.</span><span class="n">normal</span><span class="p">,</span> <span class="n">Color</span><span class="p">.</span><span class="n">green</span><span class="p">);</span>

<span class="c1">//从player身上发出向前的射线</span>
<span class="n">Debug</span><span class="p">.</span><span class="nf">DrawRay</span><span class="p">(</span><span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="p">+</span> <span class="m">0.5f</span><span class="p">,</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">z</span><span class="p">),</span> <span class="n">transform</span><span class="p">.</span><span class="n">forward</span><span class="p">,</span> <span class="n">Color</span><span class="p">.</span><span class="n">red</span><span class="p">);</span>

<span class="n">Vector3</span> <span class="n">playerLine</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="p">+</span> <span class="m">0.5f</span><span class="p">,</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="n">Physics</span><span class="p">.</span><span class="nf">Raycast</span><span class="p">(</span><span class="n">playerLine</span><span class="p">,</span> <span class="n">transform</span><span class="p">.</span><span class="n">forward</span><span class="p">,</span> <span class="k">out</span> <span class="n">objectHit</span><span class="p">,</span> <span class="m">50</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="n">objectHit</span><span class="p">.</span><span class="n">collider</span><span class="p">.</span><span class="n">tag</span> <span class="p">==</span> <span class="n">Tags</span><span class="p">.</span><span class="n">npc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">tagetAnamy</span> <span class="p">=</span> <span class="n">objectHit</span><span class="p">.</span><span class="n">collider</span><span class="p">.</span><span class="n">transform</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="监听gui-事件">监听GUI 事件</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">UnityEngine.UI</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">TMPro</span><span class="p">;</span> <span class="c1">//如果使用有 texmeshpro 的组件，需要引用命名空间</span>

<span class="k">public</span> <span class="n">GameObject</span> <span class="n">btn</span><span class="p">;</span>
<span class="k">public</span> <span class="n">GameObject</span> <span class="n">slider</span><span class="p">;</span>
<span class="k">public</span> <span class="n">GameObject</span> <span class="n">dropdown</span><span class="p">;</span>
<span class="k">public</span> <span class="n">GameObject</span> <span class="n">toggle</span><span class="p">;</span>


<span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">btn</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Button</span><span class="p">&gt;().</span><span class="n">onClick</span><span class="p">.</span><span class="nf">AddListener</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">btnOnClick</span><span class="p">);</span> <span class="c1">// 在 button 组件上添加监听方法</span>
  <span class="n">slider</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Slider</span><span class="p">&gt;().</span><span class="n">onClick</span><span class="p">.</span><span class="nf">AddListener</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">silderChange</span><span class="p">);</span> <span class="c1">// 在 slider 上添加监听方法</span>
  <span class="n">dropdown</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Dropdown</span><span class="p">&gt;().</span><span class="n">onClick</span><span class="p">.</span><span class="nf">AddListener</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">dropdownChange</span><span class="p">);</span> <span class="c1">// 在普通 dropdown 上添加监听方法</span>
  <span class="n">dropdown</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">TMP_Dropdown</span><span class="p">&gt;().</span><span class="n">onClick</span><span class="p">.</span><span class="nf">AddListener</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">dropdownChange</span><span class="p">);</span> <span class="c1">//在 TMP dropdown 上添加监听方法</span>
	<span class="n">dropdown</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Toggle</span><span class="p">&gt;().</span><span class="n">onClick</span><span class="p">.</span><span class="nf">AddListener</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">toggleIsTrue</span><span class="p">);</span> 
<span class="p">}</span> 

<span class="k">void</span> <span class="nf">btnOnClick</span><span class="p">()</span>
<span class="p">{</span>
  
<span class="p">}</span>

<span class="k">void</span> <span class="nf">sliderChange</span><span class="p">(</span><span class="kt">float</span> <span class="k">value</span><span class="p">)</span>
<span class="p">{</span>
  
<span class="p">}</span>

<span class="k">void</span> <span class="nf">dropdownChange</span><span class="p">(</span><span class="n">Int32</span> <span class="k">value</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"What you want!"</span> <span class="p">+</span> <span class="k">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">toggleIsTrue</span><span class="p">(</span><span class="kt">bool</span> <span class="k">value</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"cancel that check! "</span> <span class="p">+</span> <span class="k">value</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="跟鼠标相关的事件接口">跟鼠标相关的事件接口</h3>

<p>文档：Manual / Scripting / Event System / Supported System</p>

<p>方法不可修改参数，只能修改触发后的事件。</p>

<p>挂在哪个物体上就只能控制当前物体。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">UnityEngine</span> <span class="n">UI</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine.EventSystems</span><span class="p">;</span> <span class="c1">//要引用 event systems 才能使用里面的事件方法</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">time</span> <span class="p">:</span> <span class="n">MonoBehaviour</span><span class="p">,</span> <span class="n">IPointerDownHandler</span> <span class="c1">// Called when a pointer is pressed on the object</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">OnPointerDown</span><span class="p">(</span><span class="n">PointerEventData</span> <span class="n">eventData</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"hey you!"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="charactercontroller">CharacterController</h2>

<p>不经过 rigidbody 控制物体的运动。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="c1">// 脚本名字不可以重名，有一个组件为 CharacterController，脚本不可命名为CharacterController。</span>
<span class="k">public</span> <span class="kt">float</span> <span class="n">Speed</span> <span class="p">=</span> <span class="m">3</span><span class="p">;</span>
<span class="k">private</span> <span class="n">CharacterController</span> <span class="n">cc</span><span class="p">;</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">cc</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">CharacterController</span><span class="p">&gt;();</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">float</span> <span class="n">h</span> <span class="p">=</span> <span class="n">Input</span><span class="p">.</span><span class="nf">GetAxis</span><span class="p">(</span><span class="s">"Horizontal"</span><span class="p">);</span>
    <span class="kt">float</span> <span class="n">v</span> <span class="p">=</span> <span class="n">Input</span><span class="p">.</span><span class="nf">GetAxis</span><span class="p">(</span><span class="s">"Vertical"</span><span class="p">);</span>

    <span class="n">cc</span><span class="p">.</span><span class="nf">SimpleMove</span><span class="p">(</span><span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="p">*</span> <span class="n">Speed</span><span class="p">);</span> 
  	<span class="n">cc</span><span class="p">.</span><span class="nf">Move</span><span class="p">(</span><span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="p">*</span> <span class="n">Speed</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">);</span> <span class="c1">// move 需要给一个时间间隔，没有重力影响</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="mesh">Mesh</h2>

<p>把一个物体的 mech 修改成另一个物体的。</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="n">Mesh</span> <span class="n">mesh</span><span class="p">;</span>

<span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">MeshFilter</span><span class="p">&gt;().</span><span class="n">mesh</span> <span class="p">=</span> <span class="n">mesh</span><span class="p">;</span> <span class="c1">//复制一个实例再赋值</span>
  <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">MeshFilter</span><span class="p">&gt;().</span><span class="n">shareMesh</span> <span class="p">=</span> <span class="n">mesh</span><span class="p">;</span> <span class="c1">//直接share,性能更快</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="material">Material</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">//用  MeshRenderer 里的 material 改变物体颜色</span>
<span class="k">private</span> <span class="n">Material</span> <span class="n">mat</span><span class="p">;</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
   <span class="n">mat</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">MeshRenderer</span><span class="p">&gt;().</span><span class="n">material</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
   <span class="n">mat</span><span class="p">.</span><span class="n">color</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="nf">Lerp</span><span class="p">(</span><span class="n">mat</span><span class="p">.</span><span class="n">color</span><span class="p">,</span> <span class="n">Color</span><span class="p">.</span><span class="n">red</span><span class="p">,</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="c1">// 把物体颜色变为自定义颜色，因为 Color 是 struct 结构体，不可以单独对结构体内部元素赋值，需要先转换。color 和 vector4 可以互相转换。</span>

    <span class="k">private</span> <span class="n">Material</span> <span class="n">mat</span><span class="p">;</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">mat</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">MeshRenderer</span><span class="p">&gt;().</span><span class="n">material</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Vector4</span> <span class="n">v4</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Color</span><span class="p">(</span><span class="m">0.3f</span><span class="p">,</span> <span class="m">0.4f</span><span class="p">,</span> <span class="m">0.6f</span><span class="p">);</span> <span class="c1">//先设置一个目标颜色</span>
        <span class="n">mat</span><span class="p">.</span><span class="n">color</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="nf">Lerp</span><span class="p">(</span><span class="n">mat</span><span class="p">.</span><span class="n">color</span><span class="p">,</span> <span class="n">v4</span><span class="p">,</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">);</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="数组">数组</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="n">Sprite</span><span class="p">[]</span> <span class="n">tankSprite</span><span class="p">;</span> <span class="c1">//创建一个公开的 sprite 数组，即可把动画图片拖到数组中</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">Awake</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">sr</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">SpriteRenderer</span><span class="p">&gt;();</span>
    <span class="p">}</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">sr</span><span class="p">.</span><span class="n">sprite</span> <span class="p">=</span> <span class="n">tankSprite</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>切换怪物出现次序</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="n">GameObject</span><span class="p">[]</span> <span class="n">Monsters</span><span class="p">;</span> <span class="c1">//创建一个游戏物体组，把游戏物体拖入</span>
<span class="k">public</span> <span class="n">GameObject</span> <span class="n">activeMonster</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span> <span class="c1">//创建一个位置放置被随机到的游戏物体</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">ActivateMonster</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="nf">Range</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">Monster</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span> <span class="c1">//随机循环一组长度为 Monsters 的长度的数组</span>
  <span class="n">activeMonster</span> <span class="p">=</span> <span class="n">Monsters</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="n">activeMonster</span><span class="p">.</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="冻结解冻游戏">冻结/解冻游戏</h2>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c1">// 暂停游戏，冻结时间</span>
<span class="n">Time</span><span class="p">.</span><span class="n">timeScale</span> <span class="p">=</span> <span class="m">0f</span><span class="p">;</span>
<span class="n">Curor</span><span class="p">.</span><span class="n">visible</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span> <span class="c1">// 隐藏鼠标</span>
<span class="c1">// 回到游戏，解冻时间</span>
<span class="n">Time</span><span class="p">.</span><span class="n">timeScale</span> <span class="p">=</span> <span class="m">1f</span><span class="p">;</span>
<span class="n">Curor</span><span class="p">.</span><span class="n">visible</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span> <span class="c1">// 显示鼠标，可以点击</span>
</pre></td></tr></tbody></table></code></pre></div></div>



      </section>


      <!-- <script type="text/javascript">
        $(document).ready(function() {
        $('#toc').toc();
        });
      </script> -->



      <footer>
      <p><small>BackTo <a href="https://8ku.github.io/note_other">Home</a>  |  To<a href="javascript:scroll(0,0)"> TOP</a></small></p>
      <!--  <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p> -->
      </footer>
    </div>



    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    

  </body>
</html>
