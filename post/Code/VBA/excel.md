# Excel

## 公式

- 模糊匹配：`=VLOOKUP("*"&C2&"*",A:A,1,)`

## 算周数

### 根据日期算周数

`=WEEKNUM(TODAY(),15)`

`=WEEKNUM(DATE(2020,9,18),15)`

第二个参数表示每周开始星期

| Return_type | 星期开始于                                 |
| ----------- | ------------------------------------------ |
| 1/省略      | 星期从星期日开始。星期内的天数从1到7记数。 |
| 2           | 星期从星期一开始。星期内的天数从1到7记数。 |
| 11          | 星期从星期一开始。星期内的天数从1到7记数。 |
| 12          | 星期从星期二开始。星期内的天数从1到7记数。 |
| 13          | 星期从星期三开始。星期内的天数从1到7记数。 |
| 14          | 星期从星期四开始。星期内的天数从1到7记数。 |
| 15          | 星期从星期五开始。星期内的天数从1到7记数。 |
| 16          | 星期从星期六开始。星期内的天数从1到7记数。 |
| 17          | 星期从星期七开始。星期内的天数从1到7记数。 |
| 21          | 星期从星期一开始。星期内的天数从1到7记数。 |

### 根据周数算日期

A1：输入年

B1：输入周数

C1：开始日期 `=MAX(DATE(A1,1,1),DATE(A1,1,1)-WEEKDAY(DATE(A1,1,1),2)+(B1-1)*7-2)`

D1：结束日期 `=MIN(DATE(A1+1,1,0),DATE(A1,1,1)-WEEKDAY(DATE(A1,1,1),2)+B1*7-3)`